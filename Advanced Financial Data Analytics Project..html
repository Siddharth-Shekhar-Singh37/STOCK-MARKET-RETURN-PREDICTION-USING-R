<!DOCTYPE html>
<!-- saved from url=(0068)https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Siddharth Shekhar Singh">

<title>Advanced Financial Data Analytics Assignment</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./Advanced Financial Data Analytics Assignment 1_files/clipboard.min.js.download"></script>
<script src="./Advanced Financial Data Analytics Assignment 1_files/quarto.js.download"></script>
<script src="./Advanced Financial Data Analytics Assignment 1_files/popper.min.js.download"></script>
<script src="./Advanced Financial Data Analytics Assignment 1_files/tippy.umd.min.js.download"></script>
<script src="./Advanced Financial Data Analytics Assignment 1_files/anchor.min.js.download"></script>
<link href="./Advanced Financial Data Analytics Assignment 1_files/tippy.css" rel="stylesheet">
<link href="./Advanced Financial Data Analytics Assignment 1_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./Advanced Financial Data Analytics Assignment 1_files/bootstrap.min.js.download"></script>
<link href="./Advanced Financial Data Analytics Assignment 1_files/bootstrap-icons.css" rel="stylesheet">
<link href="./Advanced Financial Data Analytics Assignment 1_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="./Advanced Financial Data Analytics Assignment 1_files/kePrint.js.download"></script>
<link href="./Advanced Financial Data Analytics Assignment 1_files/lightable.css" rel="stylesheet">


<style>.ansi-display{font-family:monospace;white-space:pre-wrap;--ansiBlack: #000000;--ansiRed: #cd3131;--ansiGreen: #00BC00;--ansiYellow: #949800;--ansiBlue: #0451a5;--ansiMagenta: #bc05bc;--ansiCyan: #0598bc;--ansiWhite: #555555;--ansiBrightBlack: #666666;--ansiBrightRed: #cd3131;--ansiBrightGreen: #14CE14;--ansiBrightYellow: #b5ba00;--ansiBrightBlue: #0451a5;--ansiBrightMagenta: #bc05bc;--ansiBrightCyan: #0598bc;--ansiBrightWhite: #a5a5a5}.dark-mode .ansi-display{--ansiBlack: #000000;--ansiRed: #cd3131;--ansiGreen: #0DBC79;--ansiYellow: #e5e510;--ansiBlue: #2472c8;--ansiMagenta: #bc3fbc;--ansiCyan: #11a8cd;--ansiWhite: #e5e5e5;--ansiBrightBlack: #666666;--ansiBrightRed: #f14c4c;--ansiBrightGreen: #23d18b;--ansiBrightYellow: #f5f543;--ansiBrightBlue: #3b8eea;--ansiBrightMagenta: #d670d6;--ansiBrightCyan: #29b8db;--ansiBrightWhite: #e5e5e5}@keyframes ansi-displaly-run-blink{50%{opacity:0}}.fui-FluentProvider h2{border-bottom:none;padding-bottom:0}</style><style data-make-styles-bucket="d"></style><style id="fui-FluentProviderr0"></style></head>

<body class="fullcontent quarto-light" data-tabster="{&quot;root&quot;:{}}">

<i tabindex="0" role="none" data-tabster-dummy="" aria-hidden="true" style="position: fixed; height: 1px; width: 1px; opacity: 0.001; z-index: -1; content-visibility: hidden; top: 0px; left: 0px;"></i><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Advanced Financial Data Analytics Assignment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Siddharth Shekhar Singh </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb3-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"barryquinn1/tsfe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping install of 'tsfe' from a github remote, the SHA1 (fa5563f5) has not changed since last install.
  Use `force = TRUE` to force installation</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb5-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::between()     masks data.table::between()
✖ dplyr::filter()      masks stats::filter()
✖ dplyr::first()       masks data.table::first()
✖ lubridate::hour()    masks data.table::hour()
✖ lubridate::isoweek() masks data.table::isoweek()
✖ dplyr::lag()         masks stats::lag()
✖ dplyr::last()        masks data.table::last()
✖ lubridate::mday()    masks data.table::mday()
✖ lubridate::minute()  masks data.table::minute()
✖ lubridate::month()   masks data.table::month()
✖ lubridate::quarter() masks data.table::quarter()
✖ lubridate::second()  masks data.table::second()
✖ purrr::transpose()   masks data.table::transpose()
✖ lubridate::wday()    masks data.table::wday()
✖ lubridate::week()    masks data.table::week()
✖ lubridate::yday()    masks data.table::yday()
✖ lubridate::year()    masks data.table::year()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: PerformanceAnalytics
Loading required package: xts
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:data.table':

    yearmon, yearqtr

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric


######################### Warning from 'xts' package ##########################
#                                                                             #
# The dplyr lag() function breaks how base R's lag() function is supposed to  #
# work, which breaks lag(my_xts). Calls to lag(my_xts) that you type or       #
# source() into this session won't work correctly.                            #
#                                                                             #
# Use stats::lag() to make sure you're not using dplyr::lag(), or you can add #
# conflictRules('dplyr', exclude = 'lag') to your .Rprofile to stop           #
# dplyr from breaking base R's lag() function.                                #
#                                                                             #
# Code in packages is not affected. It's protected by R's namespace mechanism #
# Set `options(xts.warn_dplyr_breaks_lag = FALSE)` to suppress this warning.  #
#                                                                             #
###############################################################################

Attaching package: 'xts'

The following objects are masked from 'package:dplyr':

    first, last

The following objects are masked from 'package:data.table':

    first, last


Attaching package: 'PerformanceAnalytics'

The following object is masked from 'package:graphics':

    legend

Loading required package: quantmod
Loading required package: TTR
Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsfe)</span>
<span id="cb10-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────────────── fpp2 2.5 ──
✔ forecast  8.22.0     ✔ expsmooth 2.3   
✔ fma       2.5        
── Conflicts ───────────────────────────────────────────────── fpp2_conflicts ──
✖ purrr::transpose() masks data.table::transpose()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggfortify"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vtable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"quantmod"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"stats"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stats' is a base package, and should not be updated</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"PerformanceAnalytics"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"kableExtra"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"knitr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'ggfortify':
  method                 from    
  autoplot.Arima         forecast
  autoplot.acf           forecast
  autoplot.ar            forecast
  autoplot.bats          forecast
  autoplot.decomposed.ts forecast
  autoplot.ets           forecast
  autoplot.forecast      forecast
  autoplot.stl           forecast
  autoplot.ts            forecast
  fitted.ar              forecast
  fortify.ts             forecast
  residuals.ar           forecast</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb34-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb34-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb34-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vtable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: kableExtra</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb38-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PerformanceAnalytics)</span>
<span id="cb38-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb38-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb38-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"forecast"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"Metrics"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into '/cloud/lib/x86_64-pc-linux-gnu-library/4.2'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb42-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Metrics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:forecast':

    accuracy</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction-and-critique" class="level1">
<h1>INTRODUCTION AND CRITIQUE</h1>
<p>The ability to predict stock market returns with high accuracy remains one of the most challenging yet crucial aspects of financial analysis. This project focuses on the predictability of major stock market indices, specifically the S&amp;P 500 and FTSE indices based on historical prices, by employing traditional and modern statistical models.The intention is to uncover whether these indices show patterns of predictability that could potentially be leveraged for improved investment strategies.</p>
<p>Financial markets are notoriously difficult to forecast due to their complex and dynamic nature, which includes reactions to economic indicators, political events, and trader behavior. Given the stakes involved, even modest improvements in prediction accuracy can translate into significant economic gains. This has spurred ongoing research into both traditional and innovative forecasting methods.</p>
<p>This study delves into the effectiveness of time series forecasting models. It explores how these model can be adapted and refined to enhance its predictive power across various time horizons. The research is structured to test model efficacies using historical data across three key periods, each representing a distinct phase in market dynamics, to provide a comprehensive evaluation of its performance.</p>
<p>Ultimately, this study aims to blend rigorous quantitative analysis with insights from behavioral finance to enhance the understanding of market dynamics and improve the predictability of stock returns. The findings are intended to contribute to the ongoing discourse in financial economics by providing a clearer picture of the capabilities and limitations of current forecasting methodologies and suggesting pathways for future research.</p>
<p><sub><strong>The&nbsp;Role&nbsp;of&nbsp;ARIMA&nbsp;in&nbsp;Stock&nbsp;Price&nbsp;Prediction</strong></sub></p>
<p>The Autoregressive Integrated Moving Average (ARIMA) model is prominent in financial forecasting due to its effectiveness in capturing the linear aspects of time series data. <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7046047">Adebiyi et al.&nbsp;(2014)</a> demonstrate ARIMA’s prowess in providing reliable short-term market forecasts, using historical data from major stock exchanges. Their research underscores ARIMA’s potential to outperform more complex models, emphasizing its suitability for investors seeking robust short-term prediction tools. This project employs ARIMA to understand its efficacy across different datasets and time periods, aligning with the ongoing search for reliable predictive models in the financial sector.</p>
<p><strong>Investor Attention and Market Movements</strong></p>
<p>The dynamics of investor attention have also been shown to significantly influence market movements. <a href="https://pdf.sciencedirectassets.com/271679/1-s2.0-S0378426614X00026/1-s2.0-S0378426613004822/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjECIaCXVzLWVhc3QtMSJHMEUCIAvp6%2F7GfzKXH6bITA%2Fz0SbDJXXBAf24%2FqsUFA4tQ1BkAiEA413qK2Pge0%2FN20R%2FqO6VUyI7zDNeso9BzWy3fef00c8qswUIWxAFGgwwNTkwMDM1NDY4NjUiDHRCnx7KVz00LPmZPiqQBdn64PbXw20ir8GWosfZ5LFoEA5%2B5Ih0%2BKdrEvWqj4XWlKNkCqWHr0INd0Z2gj0o63nicxpaRqkTbJuRJh5cAcNeX2agjzH9cJOPvrCbALlFn3VLEE8Gi%2BqqIFBM4KLeaf43mhjygZ5mBY1kylcGDp6hznrd2QXaj35TJq3m7PQ1dBWmS24UP9DhgCqYxO7AThM2aBWf2ryINNnfLtJVBf985jU7peQt1WEWc4u882QWwA8duOE%2FrvkvrDUlYaMEoljIFkgyFqmHtv0xlVw2%2BexJc9U9hzkE94ZngPRgC2Hf6K3cOtI%2FIXuLtKlPnNWWlyUj9RV8MjIJRpWYiC%2BI%2BYgdtwOT2abxLKOgFsq5VGTnzoARn1SRBODX1alOW5VmMQ6WbfmgHpytW8Qv%2BGM%2FPE91d7SiuN9IIDx4xvmmoJdEOpS0zTyKoQyE22vDBuilHZ%2FU8Pz%2B1Ae7fT6QcIa7eojAINkIuOv%2FgglhvalNGbETDseA2Cormn103EX%2Fbrxc8IXXpQUTJ5GRuHO8SY5BvZV%2BGmEL17g60ghDUXrlubSUYGwed9rDPenbflRnvMfr0dUAVXOi4TM5L2kab7dhPX1G3ELbZ8ckBacICXvKIewWP%2FlmW04EHS3AdpynXq8xXzRr68qBkgx%2BvjikS3unDbe0MSSQhb%2FXsV6JuUUZq91bccoJjJosnqh44g3dmLn5DpFTcyuAYGhttq7wi6B9e4kkwO70S%2BXeBKG9q%2BvrdHSNBpQ2wcIoIGm8%2FORzhHvlyPHTi05xB8HuSsA52cJ4xHIsl6FYE1%2BmFRCIS5asjZRNlH4y1vLVWXryPXVrvLJpJegbxSdR5qdW5JPM3agRpv3XQRrhza5q0IRYgNU3RYhJMNKC5LAGOrEBoeDCFvhaf0Umg328PTq2kUwP0Ba4wJR6faolBFRKpQHbdFe90cM2Ws4R9Ov0qLq5orEDBaQTV42aPr3yQxBaXCAqLfPIbXvOL%2BbLLl4EEvIafZI%2FRKucEjodPNWL2tZQuGweTfRMkcHtLul78IM7nmiNKgsn01B1wYf4%2FwtIy1xCjT4rgT4f4q2NxNeXf2lsNnEYWu%2B162Pe5f%2FbndRloKi3KdrP58Z8gFXxKfuM6TL8&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Date=20240412T104359Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=300&amp;X-Amz-Credential=ASIAQ3PHCVTY5QTCAZEU%2F20240412%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Signature=3eaf7148bdd8d6ce085aeb1ac3c03622a32bd09cb29c09f055349e4712430bab&amp;hash=80e7b886313b17a14f674de20ca6ecff25989a30edc6237fde109f6098770018&amp;host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&amp;pii=S0378426613004822&amp;tid=spdf-3e4e49c9-6892-4274-b688-24e02bac1d06&amp;sid=8ae1bc0451298744cd5b1a4461386b953987gxrqb&amp;type=client&amp;tsoh=d3d3LnNjaWVuY2VkaXJlY3QuY29t&amp;ua=1d005a535c525a06535f&amp;rr=87329e58ed5063b5&amp;cc=gb">Da, Engelberg, and Gao (2011)</a> explore how investor behavior, driven by attention, affects stock prices and indices. They suggest that heightened attention leads to predictable patterns in stock returns, particularly in the short run. By integrating these insights, this project examines whether fluctuations in investor attention might be quantified and used to enhance the predictability of stock market indices through behavioral finance perspectives.</p>
<p><strong>Advancements in Financial Predictions Through Machine Learning</strong></p>
<p>While this project does not employ machine learning models directly, it is crucial to acknowledge advancements in this area for potential future integration. <a href="https://pdf.sciencedirectassets.com/271506/1-s2.0-S0957417411X00027/1-s2.0-S0957417410011711/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjECMaCXVzLWVhc3QtMSJGMEQCID%2FBwGz2ZUEsRuZK8k4m4wB1J0uUv4JcKVQ1IZVIG%2B8tAiB%2BmeDyA%2FaJb%2FL3BtvmasYiDk%2F00UNqBZJtotTxmBf5biqyBQhbEAUaDDA1OTAwMzU0Njg2NSIM5bpFeT%2Bh%2BzEnbtIWKo8FkeFHB9bSWe1cC5bU8BiRF0Fn9e2U1WGHKlNduh56nkTrsPNw5E8QBgUXhgDkqFfT9O0oDABtFlDCn5KeTXc0pOXNdXCj%2FGpo5lanQaUcpM7qHdul0MVHofr7EXZjQFqLFEZLs0IX8g2N1QkSfxiTrfzng7PO%2FA4sGh%2BnWX9wDAMSnv5foOL7OX58tzUjFUgIoJahJEuNGXh%2BXJID1l6E2%2BWiaSZpw6Jfx23NP%2B%2B7UWyWLQtQBl3PMtGg6XM5gtihwUKWGlX97ncuPi6rtAuHiiVVuWTAnEtK5mqRUMDCDNjtadbMVn8LcQKj4bhi1XWUW0geeJ3AZsCI8jJnLLJfx6JcKeHEG1c%2FPQPMWLsSTYDFYQ7iTB7heLRfetfnfPPYJ9mS3YRkIckKFqrsI0d5YRTLfExE2Hx%2FJxe0SyhbGOKr%2BAZsrE9t6hnCCKR3Soi7SZ%2F5bctQBYl7Aup5cAoVD285TKRnv%2BDXpLdWzjkProkTkBhVdsWSZrLaD94qmO72I4e5F092EnZq%2BXvoofz138cNllBy6yFOsRVOR5pPhFpClJ7m1qf145RulL2elx9%2BID31dO446VO47IcoEOz%2B2UFL%2BqhFkwjeq1dec6DBLUg9VnwVd4QHH41JTZHSuH7pfFUwri5nSolbDfzevYYdnjNWVV6t9msFICO3VxJP0HdyxCORP%2FcUHg8bn%2BjNlxrJWg9LMQisZ7STm8KjFx1WPZvoBsLHfte%2F3E%2FUmT6bEczRcPAAZBhl9VgoIKLjFcKyPlqCgCroXCVUTM7j3P6NoC4eaXgkORhjuli%2BHxnHlY6TywPxzpLznVakGlzBrnruCgiaUDaRC9r%2FaFkzaCQHWSXIE%2Fg%2F%2BM%2FSmImOP2IFAjDDkOSwBjqyAThWBB90ntWQV6cjKY%2B%2FfswDTennkGBzlVjBPDf60Nrve%2Fv8QGU5qz%2Bv5DX1%2F7As6mgGmVtSNfrDwJlAsSnFbvVbdg94HF97MoqTr7Biz7R%2F7r2JPqblc2coPVEUdkiWG1DjlQAXl6nyPYhjp%2FYlCOc1BboxMCf5yD6CtdB96V6mjl%2BabXNZY5c%2FWP%2FQ29ZcGRwkS5msdm6b5Z1w4kAu3Ilb4MW8g0f4%2B4j3D8DqY12mzYI%3D&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Date=20240412T104616Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=300&amp;X-Amz-Credential=ASIAQ3PHCVTYQI6NZG6V%2F20240412%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Signature=e00a12d908451a7c528901697743f071e01743fc4b0cab379510eb23e8868e1b&amp;hash=572d0ace9038de2310572dcefc86c536392ff9fdc34c0a023833b1669d3b2022&amp;host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&amp;pii=S0957417410011711&amp;tid=spdf-9bb01be2-b467-407c-abe1-87adcfef2c6e&amp;sid=8ae1bc0451298744cd5b1a4461386b953987gxrqb&amp;type=client&amp;tsoh=d3d3LnNjaWVuY2VkaXJlY3QuY29t&amp;ua=1d005a535c5202520702&amp;rr=8732a1ae4af363b5&amp;cc=gb">Kara et al.&nbsp;(2011)</a> explore the use of Artificial Neural Networks (ANNs) and Support Vector Machines (SVMs) in predicting the direction of stock price movements on the Istanbul Stock Exchange. Their findings reveal that ANNs slightly outperform SVMs, providing insights into how these advanced techniques could be further leveraged to improve prediction accuracy in financial markets. Understanding these developments helps in assessing the landscape of financial forecasting and considering future enhancements to traditional models like ARIMA.</p>
<p><strong>Novel Approach and Structure of the Paper</strong></p>
<p>In the subsequent sections of this study, we systematically explore and evaluate the performance of five distinct forecasting models to determine their predictability for the S&amp;P 500 and FTSE indices. These models include: Simple Forecasts, which utilize mean, naive, and drift methods; Moving Averages Forecast, which smoothens past data to project future values; Simple Exponential Smoothing, which applies exponentially decreasing weights to impact the forecasts; the ARIMA model, known for its robustness in time series forecasting; and Seasonal-Trend Decomposition, which separates data into seasonal, trend, and residual components.</p>
<p>Each model’s effectiveness will be rigorously assessed across three different time horizons, using historical data to provide a thorough understanding of their capabilities and limitations. The evaluations will feature detailed visualizations of actual versus forecasted values and include comprehensive analysis of accuracy test results. Through these analyses, we aim to offer a granular insight into which models best capture the dynamics of the stock indices and under what conditions they most effectively predict future movements. This endeavor will not only enhance our understanding of predictive modeling in finance but also guide future research and practical applications in financial forecasting.</p>
</section>
<section id="data-and-methods" class="level1">
<h1>DATA AND METHODS</h1>
<p>The data used for analysis in this project, has been derived from the TSFE package, which contains data of major stock indices and widely used currency exchange rates around the globe.A time period of more than 30 years has been taken into consideration for the data analysis, starting from Janaury 1st,1990 to Janaury 30th,2020. The following code chunk has been used to retrieve data using the TSFE package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb46-1" aria-hidden="true" tabindex="-1"></a>tsfe<span class="sc">::</span>indices<span class="sc">%&gt;%</span> <span class="fu">data.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             date CHINA A-DS MARKET $ - PRICE INDEX
           &lt;POSc&gt;                             &lt;num&gt;
    1: 1960-01-29                                NA
    2: 1960-02-01                                NA
    3: 1960-02-02                                NA
    4: 1960-02-03                                NA
    5: 1960-02-04                                NA
   ---                                             
15647: 2020-01-20                            722.80
15648: 2020-01-21                            707.07
15649: 2020-01-22                            711.95
15650: 2020-01-23                            688.93
15651: 2020-01-24                            688.93
       DAX 30 PERFORMANCE - PRICE INDEX DOW JONES INDUSTRIALS - PRICE INDEX
                                  &lt;num&gt;                               &lt;num&gt;
    1:                               NA                              622.62
    2:                               NA                              626.20
    3:                               NA                              636.92
    4:                               NA                              630.97
    5:                               NA                              631.14
   ---                                                                     
15647:                         13548.94                            29348.10
15648:                         13555.87                            29196.04
15649:                         13515.75                            29186.27
15650:                         13388.42                            29160.09
15651:                         13576.68                            28989.73
       FTSE ALL SHARE - PRICE INDEX GBP TO EUR (BOE) - EXCHANGE RATE
                              &lt;num&gt;                            &lt;num&gt;
    1:                           NA                               NA
    2:                           NA                               NA
    3:                           NA                               NA
    4:                           NA                               NA
    5:                           NA                               NA
   ---                                                              
15647:                      4245.57                           0.8528
15648:                      4223.35                           0.8499
15649:                      4206.93                           0.8429
15650:                      4170.34                           0.8429
15651:                      4213.14                           0.8437
       GBP TO USD (BOE) - EXCHANGE RATE
                                  &lt;num&gt;
    1:                               NA
    2:                               NA
    3:                               NA
    4:                               NA
    5:                               NA
   ---                                 
15647:                           0.7693
15648:                           0.7658
15649:                           0.7610
15650:                           0.7610
15651:                           0.7653
       GERMANY-DS NON-FIN.EX-RESOR - PRICE INDEX
                                           &lt;num&gt;
    1:                                        NA
    2:                                        NA
    3:                                        NA
    4:                                        NA
    5:                                        NA
   ---                                          
15647:                                   1171.53
15648:                                   1169.63
15649:                                   1166.40
15650:                                   1157.47
15651:                                   1166.74
       IRELAND-DS MARKET $ - PRICE INDEX
                                   &lt;num&gt;
    1:                                NA
    2:                                NA
    3:                                NA
    4:                                NA
    5:                                NA
   ---                                  
15647:                           2128.17
15648:                           2118.85
15649:                           2127.08
15650:                           2105.97
15651:                           2111.22
       JAPAN-DS NON-FIN.EX-RESOR - PRICE INDEX
                                         &lt;num&gt;
    1:                                      NA
    2:                                      NA
    3:                                      NA
    4:                                      NA
    5:                                      NA
   ---                                        
15647:                                  696.38
15648:                                  692.27
15649:                                  695.98
15650:                                  690.71
15651:                                  691.06
       NIKKEI 225 STOCK AVERAGE - PRICE INDEX RUSSELL 2000 - PRICE INDEX
                                        &lt;num&gt;                      &lt;num&gt;
    1:                                 953.03                         NA
    2:                                 962.70                         NA
    3:                                 959.48                         NA
    4:                                 958.98                         NA
    5:                                 960.70                         NA
   ---                                                                  
15647:                               24083.51                    1699.64
15648:                               23864.56                    1685.90
15649:                               24031.35                    1684.46
15650:                               23795.44                    1685.01
15651:                               23827.18                    1662.23
       S&amp;P 500 COMPOSITE - PRICE INDEX
                                 &lt;num&gt;
    1:                              NA
    2:                              NA
    3:                              NA
    4:                              NA
    5:                              NA
   ---                                
15647:                         3329.62
15648:                         3320.79
15649:                         3321.75
15650:                         3325.54
15651:                         3295.47
       S&amp;P 500 COMPOSITE DS CALCULATED - PRICE INDEX
                                               &lt;num&gt;
    1:                                            NA
    2:                                            NA
    3:                                            NA
    4:                                            NA
    5:                                            NA
   ---                                              
15647:                                       3444.97
15648:                                       3435.89
15649:                                       3436.91
15650:                                       3440.77
15651:                                       3409.51
       UK £ BROAD INDEX JAN 05=100 (BOE) - TRADE WEIGHTED
                                                    &lt;num&gt;
    1:                                                 NA
    2:                                                 NA
    3:                                                 NA
    4:                                                 NA
    5:                                                 NA
   ---                                                   
15647:                                            79.3600
15648:                                            79.7238
15649:                                            80.3264
15650:                                            80.3443
15651:                                            80.1261
       UK £ EFFECTIVE INDEX JAN 05=100 (BOE) - TRADE WEIGHTED
                                                        &lt;num&gt;
    1:                                                     NA
    2:                                                     NA
    3:                                                     NA
    4:                                                     NA
    5:                                                     NA
   ---                                                       
15647:                                                79.9174
15648:                                                80.2745
15649:                                                80.8928
15650:                                                80.9074
15651:                                                80.6907
       UK-DS NON-FIN.EX-RESOR - PRICE INDEX USD TO GBP (BOE) - EXCHANGE RATE
                                      &lt;num&gt;                            &lt;num&gt;
    1:                                   NA                               NA
    2:                                   NA                               NA
    3:                                   NA                               NA
    4:                                   NA                               NA
    5:                                   NA                               NA
   ---                                                                      
15647:                              6895.06                           1.2998
15648:                              6870.89                           1.3058
15649:                              6841.67                           1.3058
15650:                              6793.87                           1.3058
15651:                              6868.01                           1.3067
       WORLD-DS Market - PRICE INDEX
                               &lt;num&gt;
    1:                            NA
    2:                            NA
    3:                            NA
    4:                            NA
    5:                            NA
   ---                              
15647:                       2198.69
15648:                       2188.37
15649:                       2190.68
15650:                       2183.18
15651:                       2175.40</code></pre>
</div>
</div>
<p>In this project,for our index price prediction model,past data of two, most influential indexes around the world, S&amp;P500 and FTSE All-Share price will be used for further analysis. Therefore, data, only from the columns C5(FTSE All-Share price index) and C13(S&amp;P 500 Composite) will be extracted along with the date column C1.The provided R script is designed to extract financial indices data,specifically focusing on the S&amp;P 500 and FTSE All-Share Price Index, within a specified date range from 1Janaury 1990 to 30 janaury 2020. It makes use of packages like <strong><code>dplyr</code></strong> for data manipulation and <strong><code>lubridate</code></strong> for date handling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb48-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># for handling dates</span></span>
<span id="cb48-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># for data manipulation</span></span>
<span id="cb48-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the start and end dates for the data extraction</span></span>
<span id="cb48-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-6" aria-hidden="true" tabindex="-1"></a>start_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"1990-01-01"</span>) <span class="co"># Convert string to Date object for start date</span></span>
<span id="cb48-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-7" aria-hidden="true" tabindex="-1"></a>end_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2020-01-30"</span>) <span class="co"># Convert string to Date object for end date</span></span>
<span id="cb48-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting S&amp;P 500 data from 'tsfe::indices'</span></span>
<span id="cb48-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># First, select the date and S&amp;P 500 price columns. Then, filter rows by date range</span></span>
<span id="cb48-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-11" aria-hidden="true" tabindex="-1"></a>DataframeSP500 <span class="ot">&lt;-</span> <span class="fu">subset</span>(tsfe<span class="sc">::</span>indices, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">13</span>))</span>
<span id="cb48-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-12" aria-hidden="true" tabindex="-1"></a>SP500 <span class="ot">&lt;-</span> DataframeSP500 <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> date <span class="sc">&lt;=</span> end_date) </span>
<span id="cb48-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(SP500) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'date'</span>,<span class="st">'price'</span>) <span class="co"># Assigning column names for clarity</span></span>
<span id="cb48-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting FTSE All-Share Price Index data from 'tsfe::indices'</span></span>
<span id="cb48-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Similar process as above, focusing on the FTSE index this time</span></span>
<span id="cb48-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-18" aria-hidden="true" tabindex="-1"></a>DataframeFTSE <span class="ot">&lt;-</span> <span class="fu">subset</span>(tsfe<span class="sc">::</span>indices, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>))</span>
<span id="cb48-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-19" aria-hidden="true" tabindex="-1"></a>FTSE_PRICE_INDEX <span class="ot">&lt;-</span> DataframeFTSE <span class="sc">%&gt;%</span></span>
<span id="cb48-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;=</span> start_date <span class="sc">&amp;</span> date <span class="sc">&lt;=</span> end_date)</span>
<span id="cb48-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(FTSE_PRICE_INDEX) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'date'</span>,<span class="st">'price'</span>) <span class="co"># Assigning column names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#<strong>LOG RETURNS</strong>- Logarithmic returns,commonly referred to as “log returns,”play a very crucial role in financial analysis, mainly in the prediction of stock indexes.Unlike simple returns,Logarithmic returns are derived from natural logarithms of the ratio of closing prices of two consecutive periods. This method does have several advantages that make it attractive to financial econometrics. First, log-returns are time additive;which means that the log return over a period is the sum of the log returns of its constituent sub-periods.Due to this property,it easily leads to the computation of returns in all time frames and allows for their aggregation or comparison across different investment opportunities with varying time spans. Secondly, the log returns are much more useful for the analysis of multiple assets over time,because their symmetric treatment of equivalent percentage gains and losses.For instance, a 5% gain followed by a 5% loss results in a net change different from zero in simple returns but nets to zero in log returns, reflecting the true economic reality.</p>
<p>In the context of predicting stock indexes like the S&amp;P 500 or the FTSE All-Share Price Index, using log returns facilitates the application of statistical models that assume normally distributed returns, enhancing the accuracy of predictions and analyses.This R code is used to calculate the logarithmic returns of the two financial indices taken into consideration: the S&amp;P 500 and the FTSE All-Share Price Index. The slice(-1) function will remove the first row of the resulting data frame due to the lack of preceding price for the first entry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate logarithmic returns for S&amp;P 500</span></span>
<span id="cb49-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-2" aria-hidden="true" tabindex="-1"></a>SP500_Log_Returns <span class="ot">&lt;-</span> SP500 <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_return =</span> <span class="fu">log</span>(price) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">lag</span>(price))) <span class="sc">%&gt;%</span> <span class="co"># Calculate log returns</span></span>
<span id="cb49-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="co"># Remove the first row with NA in log_return</span></span>
<span id="cb49-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate logarithmic returns for FTSE All-Share Price Index</span></span>
<span id="cb49-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-7" aria-hidden="true" tabindex="-1"></a>FTSE_Log_Returns <span class="ot">&lt;-</span> FTSE_PRICE_INDEX <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_return =</span> <span class="fu">log</span>(price) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">lag</span>(price))) <span class="sc">%&gt;%</span> <span class="co"># Calculate log returns</span></span>
<span id="cb49-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="co"># Remove the first row with NA in log_return</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following code attempts to display logarithmic returns with respect to time for both S&amp;P 500 and FTSE Price Index. The package employed in creating the visualization is ggplot2, a powerful yet flexible package within R, is used in creating graphics.The key purpose of the visualization, is to analyze the trend of returns over time, periods of volatility and how they relate to the price movements.The color gradient provides a visual cue to price changes alongside the log returns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for S&amp;P 500 Logarithmic Returns</span></span>
<span id="cb50-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-2" aria-hidden="true" tabindex="-1"></a>SP500_Log_Returns <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> log_return <span class="sc">*</span> <span class="dv">100</span>, <span class="at">color =</span> price)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb50-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Add trend line</span></span>
<span id="cb50-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Price Level"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb50-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Log Return (%)"</span>,</span>
<span id="cb50-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"S&amp;P 500 Logarithmic Returns"</span>,</span>
<span id="cb50-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Color represents price level"</span>,</span>
<span id="cb50-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data Source: tsfe::indices"</span></span>
<span id="cb50-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb50-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb50-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb50-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb50-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb50-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb50-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb50-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Plot for FTSE Price Index Logarithmic Returns</span></span>
<span id="cb52-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-2" aria-hidden="true" tabindex="-1"></a>FTSE_Log_Returns <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> log_return <span class="sc">*</span> <span class="dv">100</span>, <span class="at">color =</span> price)) <span class="sc">+</span></span>
<span id="cb52-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb52-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span>  <span class="co"># Add trend line</span></span>
<span id="cb52-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"green"</span>, <span class="at">high =</span> <span class="st">"yellow"</span>, <span class="at">name =</span> <span class="st">"Price Level"</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb52-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Log Return (%)"</span>,</span>
<span id="cb52-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"FTSE Price Index Logarithmic Returns"</span>,</span>
<span id="cb52-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Color represents price level"</span>,</span>
<span id="cb52-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data Source: tsfe::indices"</span></span>
<span id="cb52-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb52-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb52-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb52-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb52-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb52-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb52-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb52-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The generated figures for logarithmic returns of S&amp;P500 and FTSE Price index,helps us easily locate the period of high volatility for both the indices. It is clearly visible that, around 2007-08, both the indices faced high volatility and subsequent lower returns,clearly, which was the period of recession arising from US housing crisis.</p>
<p>Summarizing the log returns, to get an overview of statistical measures like mean, median, standard deviation, and quartiles, as this helps in analysing the return distribution and identifying patterns or outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 Log Return Summary</span></span>
<span id="cb54-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">st</span>(SP500_Log_Returns, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">'log_return'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Std. Dev.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctl. 25</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctl. 75</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">log_return</td>
<td style="text-align: left;">7844</td>
<td style="text-align: left;">0.00028</td>
<td style="text-align: left;">0.011</td>
<td style="text-align: left;">-0.095</td>
<td style="text-align: left;">-0.004</td>
<td style="text-align: left;">0.0053</td>
<td style="text-align: left;">0.11</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE PRICE INDEX Log Return Summary</span></span>
<span id="cb55-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st</span>(FTSE_Log_Returns, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">'log_return'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">N</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Std. Dev.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctl. 25</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Pctl. 75</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">log_return</td>
<td style="text-align: left;">7844</td>
<td style="text-align: left;">0.00016</td>
<td style="text-align: left;">0.0099</td>
<td style="text-align: left;">-0.087</td>
<td style="text-align: left;">-0.0046</td>
<td style="text-align: left;">0.0051</td>
<td style="text-align: left;">0.088</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>The summary statistics of the logarithmic returns of S&amp;P500 and FTSE Price Index provides a number of valuable insights about the behaviour of these indexes over the observed period. For the S&amp;P500, the average log return is slightly higher at 0.00028 compared to the FTSE Price Index’s mean log return of 0.00016, indicating a marginally higher average daily performance over the period studied.The standard deviation, a measure of volatility, is also higher for the S&amp;P 500 (0.011) than for the FTSE Price Index (0.0099), suggesting that the S&amp;P 500 experienced slightly greater daily price fluctuations, which could indicate higher risk or greater opportunity for traders.</p>
<p>The given code has been designed for the visualization of the distribution of logarithmic returns for the S&amp;P 500 and FTSE Price Index using density plots. Additionally, it overlays a normal distribution curve on each density plot. The visualization has been done to compare the empirical distribution of log returns with a theoretical normal distribution, which is a common practice in financial data analysis to assess the normality of returns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot for S&amp;P 500 log returns with normal distribution overlay</span></span>
<span id="cb56-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-4" aria-hidden="true" tabindex="-1"></a>SP500_Log_Returns <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>log_return)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Adjusted density color and transparency</span></span>
<span id="cb56-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>dnorm, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(SP500_Log_Returns<span class="sc">$</span>log_return, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb56-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sd=</span><span class="fu">sd</span>(SP500_Log_Returns<span class="sc">$</span>log_return, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb56-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"darkgreen"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span>  <span class="co"># Normal distribution curve</span></span>
<span id="cb56-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Log Return"</span>, <span class="at">y=</span><span class="st">"Density of Probability"</span>, <span class="at">title=</span><span class="st">"S&amp;P 500 with Normal Distribution Overlay"</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Clean theme</span></span>
<span id="cb56-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),  <span class="co"># Center title</span></span>
<span id="cb56-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb56-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))  <span class="co"># Adjust text size for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot for FTSE Price Index log returns with normal distribution overlay</span></span>
<span id="cb58-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-2" aria-hidden="true" tabindex="-1"></a>FTSE_Log_Returns <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>log_return)) <span class="sc">+</span></span>
<span id="cb58-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">"lightcoral"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Adjusted density color and transparency</span></span>
<span id="cb58-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span>dnorm, <span class="at">args=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="fu">mean</span>(FTSE_Log_Returns<span class="sc">$</span>log_return, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb58-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sd=</span><span class="fu">sd</span>(FTSE_Log_Returns<span class="sc">$</span>log_return, <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb58-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"purple"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span>  <span class="co"># Normal distribution curve</span></span>
<span id="cb58-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Log Return"</span>, <span class="at">y=</span><span class="st">"Density of Probability"</span>, <span class="at">title=</span><span class="st">"FTSE Price Index with Normal Distribution Overlay"</span>) <span class="sc">+</span></span>
<span id="cb58-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Clean theme</span></span>
<span id="cb58-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),  <span class="co"># Center title</span></span>
<span id="cb58-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))  <span class="co"># Adjust text size for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>By visualizing of the distribution of logarithmic returns for the S&amp;P 500 and FTSE Price Index using density plots,we can infer that, for both indices, the peaks of the empirical distributions are higher and sharper than the normal distribution suggests leptokurtosis,which means, that there are more data clustering around the mean and more extreme values than a normal distribution would predict. This phenomena is typical in financial returns which suggests that using models which assume normality may underestimate the probability of extreme movements in market prices.However,the S&amp;P 500’s log returns are more concentrated around the mean and may follow a normal distribution more closely than the FTSE returns do.</p>
<p><strong>PREPARING DATA TO FORECAST</strong></p>
<p>For the purpose of forecasting the indices with the selected models that will be acknowledged in the upcoming sections, first we need to group the data for S&amp;P500 and FTSE price index dataframes into monthly data sets by calculating mean prices of each month in the dataset.The code performs data manipulation on two datasets: <strong><code>SP500</code></strong> and <strong><code>FTSE_PRICE_INDEX</code></strong>, representing the S&amp;P 500 and FTSE Price Index data, respectively. Its main goals are:</p>
<ol type="1">
<li><p><strong>Date Decomposition</strong>: Extract the month and year from the <strong><code>date</code></strong> column to enable grouping by these time units.</p></li>
<li><p><strong>Data Aggregation</strong>: Group the data by year and month, then calculate the average (mean) price for each group. This process condenses daily (or irregular) price data into monthly averages, making trends over time more discernible and the data less noisy.</p></li>
</ol>
<p>The provided code leverages <strong><code>dplyr</code></strong> and <strong><code>lubridate</code></strong> libraries to organize the data on a monthly basis and calculate the average price for each month. This transformation is useful for time series analysis, forecasting, and identifying long-term trends.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using lubridate to extract the month from the date column in the SP500 dataset and assign it to a new column</span></span>
<span id="cb59-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-2" aria-hidden="true" tabindex="-1"></a>SP500<span class="sc">$</span>month <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">month</span>(SP500<span class="sc">$</span>date)</span>
<span id="cb59-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using lubridate to extract the year from the date column in the SP500 dataset and assign it to a new column</span></span>
<span id="cb59-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-5" aria-hidden="true" tabindex="-1"></a>SP500<span class="sc">$</span>year <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">year</span>(SP500<span class="sc">$</span>date)</span>
<span id="cb59-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping the SP500 data by year and month, then calculate the mean of the price for each group</span></span>
<span id="cb59-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The resulting data frame, SP500_Mean, contains the average price for each month of each year</span></span>
<span id="cb59-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-9" aria-hidden="true" tabindex="-1"></a>SP500 <span class="sc">%&gt;%</span> </span>
<span id="cb59-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span> </span>
<span id="cb59-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">priceMean =</span> <span class="fu">mean</span>(price)) <span class="ot">-&gt;</span> </span>
<span id="cb59-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb59-12" aria-hidden="true" tabindex="-1"></a>  SP500_Mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replicating the process for the FTSE_PRICE_INDEX dataset</span></span>
<span id="cb61-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the month and year from the date column and assign them to new columns</span></span>
<span id="cb61-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-3" aria-hidden="true" tabindex="-1"></a>FTSE_PRICE_INDEX<span class="sc">$</span>month <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">month</span>(FTSE_PRICE_INDEX<span class="sc">$</span>date)</span>
<span id="cb61-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-4" aria-hidden="true" tabindex="-1"></a>FTSE_PRICE_INDEX<span class="sc">$</span>year <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">year</span>(FTSE_PRICE_INDEX<span class="sc">$</span>date)</span>
<span id="cb61-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouping the FTSE_PRICE_INDEX data by year and month, then calculate the mean of the price for each group</span></span>
<span id="cb61-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The resulting data frame, FTSE_Mean, contains the average price for each month of each year, similar to the SP500_Mean data frame</span></span>
<span id="cb61-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-8" aria-hidden="true" tabindex="-1"></a>FTSE_PRICE_INDEX <span class="sc">%&gt;%</span> </span>
<span id="cb61-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span> </span>
<span id="cb61-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">priceMean =</span> <span class="fu">mean</span>(price)) <span class="ot">-&gt;</span> </span>
<span id="cb61-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb61-11" aria-hidden="true" tabindex="-1"></a>  FTSE_Mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>The following code chunk is designed to convert the mean price data for the S&amp;P 500 and FTSE Price Index into their respective time series objects, which can further be used for the purpose of time series analysis and forecasting.Converting the mean price data into time series objects will allow application of time series analysis techniques, including trend analysis, seasonality detection, and forecasting future values based on historical data.The use of monthly data points (indicated by <strong><code>frequency=12</code></strong>) suggests an interest in capturing monthly trends and patterns in the financial indices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting the S&amp;P 500 mean monthly price data into a time series object</span></span>
<span id="cb63-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-2" aria-hidden="true" tabindex="-1"></a>SP500_m_ts <span class="ot">&lt;-</span> SP500_Mean<span class="sc">$</span>priceMean <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.ts</span>(<span class="at">frequency=</span><span class="dv">12</span>,    <span class="co"># Indicates monthly data</span></span>
<span id="cb63-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">1</span>), <span class="co"># The start of the time series (January 1990)</span></span>
<span id="cb63-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">end=</span><span class="fu">c</span>(<span class="dv">2020</span>,<span class="dv">1</span>))   <span class="co"># The end of the time series (January 2020)</span></span>
<span id="cb63-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting the FTSE Price Index mean monthly price data into a time series object</span></span>
<span id="cb63-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-8" aria-hidden="true" tabindex="-1"></a>FTSE_m_ts <span class="ot">&lt;-</span> FTSE_Mean<span class="sc">$</span>priceMean <span class="sc">%&gt;%</span></span>
<span id="cb63-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.ts</span>(<span class="at">frequency=</span><span class="dv">12</span>,<span class="co"># Indicates monthly data</span></span>
<span id="cb63-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">1</span>),<span class="co"># The start of the time series (January 1990)</span></span>
<span id="cb63-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb63-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">end=</span><span class="fu">c</span>(<span class="dv">2020</span>,<span class="dv">1</span>))   <span class="co"># The end of the time series (January 2020)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#Creating training and test subsets from the S&amp;P 500 and FTSE Price Index time series data: In order to evaluate the forecasts with the actual prices, the time series data of both the indices has been divided into three time horizons.The first time horizon includes data from Jan 1990-Jan 1998 as trained data.The second horizon consists of data from Jan 1990- Jan 2008 as trained data.Lastly,in the third time horizon,trained data uses data from Jan 1990-Jan 2018.All the three trained datasets of both the indices, having different time horizons, will be used to forecast the next 24 months succeeding to the training data period. The following code is designed to create training and test subsets from the S&amp;P 500 and FTSE Price Index time series data for different time periods. This is a common practice in time series analysis and forecasting, where you train models on one segment of the data (training set) and test the model’s predictions on another segment (test set). The time periods defined here are:</p>
<ol type="1">
<li><p>1990-2000</p></li>
<li><p>1990-2010</p></li>
<li><p>1990-2020</p></li>
</ol>
<p>For each period, the code aims to split the time series into two parts: one for training and one for testing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating training and test sets for S&amp;P 500 data</span></span>
<span id="cb64-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1990-2000 S&amp;P 500</span></span>
<span id="cb64-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-4" aria-hidden="true" tabindex="-1"></a>trainsp1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SP500_m_ts, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">96</span>))  <span class="co"># Training set</span></span>
<span id="cb64-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-5" aria-hidden="true" tabindex="-1"></a>SP1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SP500_m_ts, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">96</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">120</span>))  <span class="co"># Test set</span></span>
<span id="cb64-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1990-2010 S&amp;P 500</span></span>
<span id="cb64-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-8" aria-hidden="true" tabindex="-1"></a>trainsp2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SP500_m_ts, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">228</span>))</span>
<span id="cb64-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-9" aria-hidden="true" tabindex="-1"></a>SP2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SP500_m_ts, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">228</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">252</span>))</span>
<span id="cb64-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 1990-2020 S&amp;P 500</span></span>
<span id="cb64-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-12" aria-hidden="true" tabindex="-1"></a>trainsp3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SP500_m_ts, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">337</span>))</span>
<span id="cb64-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-13" aria-hidden="true" tabindex="-1"></a>SP3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(SP500_m_ts, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">337</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">361</span>))</span>
<span id="cb64-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating training and test sets for FTSE Price Index data</span></span>
<span id="cb64-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 1990-2000 FTSE Price Index</span></span>
<span id="cb64-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-18" aria-hidden="true" tabindex="-1"></a>FTSEtrain1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(FTSE_m_ts, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">96</span>))</span>
<span id="cb64-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-19" aria-hidden="true" tabindex="-1"></a>FTSE1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(FTSE_m_ts, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">96</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">120</span>))</span>
<span id="cb64-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 1990-2010 FTSE Price Index</span></span>
<span id="cb64-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-22" aria-hidden="true" tabindex="-1"></a>FTSEtrain2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(FTSE_m_ts, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">228</span>))</span>
<span id="cb64-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-23" aria-hidden="true" tabindex="-1"></a>FTSE2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(FTSE_m_ts, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">228</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">252</span>))</span>
<span id="cb64-24"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 1990-2020 FTSE Price Index</span></span>
<span id="cb64-26"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-26" aria-hidden="true" tabindex="-1"></a>FTSEtrain3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(FTSE_m_ts, <span class="at">end=</span><span class="fu">c</span>(<span class="dv">337</span>))</span>
<span id="cb64-27"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb64-27" aria-hidden="true" tabindex="-1"></a>FTSE3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(FTSE_m_ts, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">337</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">361</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>#FORECASTING TECHNIQUES</strong></p>
<p>Forecasting in finance is the process of making predictions about future financial market movements based on historical data and analysis. It is a crucial aspect of financial planning and investment strategy, enabling investors, traders, and financial institutions to make informed decisions. The significance of forecasting in financial markets cannot be overstated; it helps in assessing market trends, managing risks, optimizing portfolio allocations, and identifying investment opportunities. Accurate forecasts can lead to significant financial gains, while erroneous predictions can lead to substantial losses.</p>
<p>Significance of Forecasting in Financial Markets Forecasting plays a pivotal role in financial markets by providing insights into future market conditions. It allows for proactive risk management, efficient resource allocation, and strategic decision-making. In the volatile environment of financial markets, the ability to anticipate price movements and market trends gives investors and institutions a competitive edge.</p>
<p><strong>SIMPLE FORECAST</strong></p>
<p>To initialise with the objective of the project,we started with Simple Forecasting Mean, Naive, and Drift Methods. Each of these methods offers a unique approach to understanding and predicting future market behavior based on historical data.</p>
<p><strong>Simple Forecasting Mean</strong>: This technique involves calculating the average of all past observations as the forecast for future values. Essentially, it suggests that the best estimate of what will happen in the future is the average of everything that has happened up to now. In applying this method, we assume that all historical prices are equally important and informative about future prices, which makes it straightforward but sometimes overly simplistic for complex market movements.</p>
<p><strong>Naive Method</strong>: The Naive forecasting method is perhaps the simplest of all, where the forecast for the next period is taken to be the actual observed value of the last period. This method operates under the assumption that the most recent observation carries the most weight in predicting future values. In our project, this approach helped us establish a baseline for forecast accuracy, providing a clear point of comparison for the effectiveness of more sophisticated methods.</p>
<p><strong>Drift Method</strong>: A slight variation on the Naive Method, the Drift forecasting technique allows for changes over time by incorporating a consistent average change observed in the past. It extrapolates this average change into the future, effectively adding a “drift” to the naive forecast. This method is particularly useful when there’s a noticeable trend in the data, as it adjusts for the direction and magnitude of that trend when making future predictions.</p>
<p>For our project, exploring these different techniques provided us with a rich understanding of various forecasting methods and their applicability to financial data. While the Simple Forecasting Mean offered a broad, averaged outlook, the Naive Method gave us an immediate, last-observed-value perspective. The Drift Method, on the other hand, introduced a trend-adjusted approach, adding valuable nuance to our forecasts. Each method contributed to our overarching goal of accurately predicting index prices, highlighting the importance of selecting the right forecasting technique based on the specific characteristics of the data at hand.</p>
<p><strong>SIMPLE MOVING AVERAGE FORECAST</strong></p>
<p>SMA is essentially the arithmetic mean of a given set of prices over the specified number of days in the past, and it’s calculated by adding up some set of numbers and then dividing the sum by the count of those numbers. For instance, if we’re looking at a 10-day SMA, we’d add up the prices from the last 10 days and divide by 10. This technique helps us smooth out the data to identify the trend direction over a certain period, making it easier to forecast future prices by eliminating the ‘noise’ from random short-term fluctuations.</p>
<p>However,Moving average forecasts have its own limitations.Since moving averages are based on past data, there’s always a delay. This means they might not catch quick turns or sudden stops in the market until after they’ve begun. Secondly,If your data has regular ups and downs at certain times of the year, a simple moving average won’t pick up on these patterns. It treats all data points equally, missing out on seasonal trends.</p>
<p>Using SMA allowed us to look back over different intervals,to see how the average prices at these intervals could influence our predictions about future index prices. This approach is particularly useful for understanding general market directions, though it’s worth noting that SMA relies heavily on historical data and assumes that past trends will continue into the future, which isn’t always the case.</p>
<p><strong>SIMPLE EXPONENTIAL SMOOTHING</strong></p>
<p>Simple Exponential Smoothing (SES) is a forecasting technique in which more recent observations are given more weight in forecasting the future, and this weighting decreases exponentially for older data. At the heart of SES is a parameter called the smoothing factor, often denoted by α. This factor ranges between 0 and 1 and determines how much weight recent observations receive. A higher α means more emphasis on the latest data point, making the forecast more responsive to recent changes. You can think of SES as a way to smooth out the randomness or noise in the data, making the overall direction or level more apparent.</p>
<p>Simple Exponential Smoothing (SES) stands out for its elegance and simplicity, making it particularly appealing for those new to forecasting or when working with data that doesn’t showcase pronounced trends or seasonal shifts. Its core advantage lies in the flexibility offered by the smoothing factor (α), which allows us to adjust how much recent observations influence the forecast. This adaptability can make SES an effective tool for smoothing out random fluctuations and highlighting the underlying patterns in the data. However, this simplicity and flexibility come with their own set of challenges. Since SES inherently lacks the mechanism to account for trends or seasonality, its application is best suited for more stable datasets. Furthermore, the selection of α is pivotal; an ill-chosen smoothing factor can lead the forecast to either overreact to minor variations (if too high) or lag behind significant changes (if too low). Thus, while SES provides a streamlined approach to forecasting, understanding and navigating its limitations is crucial for making the most out of its application in predicting future values.</p>
<p><strong>ARIMA</strong></p>
<p>The ARIMA model, an acronym for AutoRegressive Integrated Moving Average,a comprehensive approach that blends AutoRegressive (AR), Integrated (I), and Moving Average (MA) components to forecast future trends by modeling time series data:</p>
<p><strong>AR(AutoRegressive):</strong>leverages the influence of preceding values to predict future ones, embodying the concept that past trends may offer insights into future directions.</p>
<p><strong>I(Integrated):</strong> addresses data stationarity by differencing data points, thereby mitigating trends and making the series more consistent over time.</p>
<p><strong>MA (Moving Average):</strong>the MA portion incorporates the idea that past forecasting errors can be used to correct future forecasts, adding a layer of self-correction to the predictive process.</p>
<p>Deploying ARIMA, requires selecting the optimal parameters: ‘p’ for the AR term, ‘d’ for the degree of differencing in the I component, and ‘q’ for the MA segment. This selection process is pivotal, as it directly influences the model’s effectiveness. ‘p’ reflects the number of lag observations included in the model, ‘d’ indicates the number of times the raw observations are differenced, and ‘q’ specifies the size of the moving average window. The function(auto.arima) automatically tests out a bunch of different combinations of parameters from your data and tries to figure out the best settings that make the most sense for predicting future trends accurately. It considers things like how the data is trending over time or if there are any seasonal patterns, and then it picks the parameters that best capture those characteristics.</p>
<p>While ARIMA proved invaluable in understanding and forecasting our data’s behavior, its complexity and the preliminary steps required for stationarity can be highlighted as an area for potential improvement and integrating machine learning models could offer more streamlined and potentially more accurate forecasting approaches.</p>
<p><strong>TIME SERIES DECOMPOSITION</strong></p>
<p>Time Series Decomposition is a technique used to dissect a time series into its core components: trend, seasonality, and residuals (or irregularities). This method allows us to see the underlying patterns in the data more clearly by separating out the predictable parts (like gradual increases/decreases over time or recurring seasonal patterns) from the unpredictable noise.Let’s understand each component specifically:</p>
<p><strong>Trend</strong>: This component represents the long-term progression of the series, showing how the data moves upwards or downwards over time.</p>
<p><strong>Seasonality</strong>: These are the patterns that repeat at regular intervals, such as monthly sales spikes or annual fluctuations.</p>
<p><strong>Residuals</strong>: Also known as the error component, these are what’s left after the trend and seasonal components have been removed from the time series. They represent the randomness or the irregular fluctuations in the data.</p>
<p>Decomposition can be done in two ways: additive, where we assume the components are added together (useful when the seasonal variations are roughly constant), and multiplicative, where we assume components are multiplied together (useful when seasonal variations change proportionally to the level of the trend).</p>
<p>Again, Time Series decomposition has its own limitations. As, decomposition assumes that seasonal patterns remain consistent over time, which might not hold true for all datasets. Real-world seasonality can evolve, but decomposition doesn’t automatically adjust for such changes.</p>
<p><strong>ACCURACY TEST</strong></p>
<ul>
<li><p><strong>RMSE (Root Mean Square Error)</strong>: RMSE is a standard way to measure the error of a model in predicting quantitative data. Formally, it is the square root of the average of the squares of the differences between predicted and observed values. In predictive modeling, RMSE is a measure of the magnitude of residuals, which are the deviations between the values predicted by a model and the values actually observed. RMSE is particularly sensitive to large errors because it squares the residuals before averaging, thus giving a relatively high weight to large errors. This property can be useful when large errors are particularly undesirable.</p></li>
<li><p><strong>MAE (Mean Absolute Error)</strong>: MAE measures the average magnitude of errors in a set of predictions, without considering their direction. It’s the average over the test sample of the absolute differences between prediction and actual observation where all individual differences have equal weight. This metric gives an idea of how wrong the predictions are; a MAE of zero means that there is no error, which is ideal but typically not possible with real-world data.</p></li>
<li><p><strong>MAPE (Mean Absolute Percentage Error)</strong>: MAPE is a measure of prediction accuracy in a forecasting model. It expresses accuracy as a percentage, and it is defined as the average absolute percent error for each time period minus actual values divided by actual values. This metric can be misleading if there are zero or near-zero actual values because the MAPE becomes infinite or excessively high. Despite this, MAPE is a widely used metric because it is easy to understand and explain.</p></li>
<li><p><strong>AIC (Akaike Information Criterion)</strong>: AIC is a measure of the relative quality of statistical models for a given set of data. It provides a means for model selection. AIC estimates the relative amount of information lost by a given model: the less information a model loses, the higher the quality of that model. In practice, AIC rewards the goodness of fit (as assessed by the likelihood function), but it also includes a penalty that is an increasing function of the number of estimated parameters. The penalty discourages overfitting, which is an important consideration in model selection where additional parameters can improve the fit on the training data but might not improve the model’s ability to predict new data.</p>
<p>In the context of forecasting index prices, these metrics would be used to compare the performance of different models, with a preference for models that have lower values of RMSE, MAE, MAPE, and AIC. This suggests the model is more accurate (RMSE, MAE), has errors that are smaller in proportion to the actual values (MAPE), and balances model complexity with the goodness of fit (AIC).</p></li>
</ul>
<p><strong>RESULTS</strong></p>
<p><em>Creating Simple forecast elements</em>:This code is designed to generate simple forecasts for the S&amp;P 500 and FTSE Price Index using historical data up to the years 2000, 2010, and 2020. It employs three different forecasting methods—mean, naive, and random walk with drift—to project future values over the next 24 months. These methods provide a baseline for evaluating the predictability of the financial time series and are useful for understanding the general trend and variability in the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary forecasting library</span></span>
<span id="cb65-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb65-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Forecasts for the year 2000 ----</span></span>
<span id="cb65-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 Forecasts</span></span>
<span id="cb65-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-7" aria-hidden="true" tabindex="-1"></a>fcmSP2000 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(trainsp1, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))  <span class="co"># Forecast using the historical mean</span></span>
<span id="cb65-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-8" aria-hidden="true" tabindex="-1"></a>fcnSP2000 <span class="ot">&lt;-</span> <span class="fu">naive</span>(trainsp1, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))  <span class="co"># Naive forecast, using the last observed value</span></span>
<span id="cb65-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-9" aria-hidden="true" tabindex="-1"></a>fcdSP2000 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(trainsp1, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))  <span class="co"># Random walk with drift</span></span>
<span id="cb65-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Price Index Forecasts</span></span>
<span id="cb65-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-12" aria-hidden="true" tabindex="-1"></a>fcmFTSE2000 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(FTSEtrain1, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-13" aria-hidden="true" tabindex="-1"></a>fcnFTSE2000 <span class="ot">&lt;-</span> <span class="fu">naive</span>(FTSEtrain1, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-14" aria-hidden="true" tabindex="-1"></a>fcdFTSE2000 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(FTSEtrain1, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Forecasts for the year 2010 ----</span></span>
<span id="cb65-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 Forecasts</span></span>
<span id="cb65-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-19" aria-hidden="true" tabindex="-1"></a>fcmSP2010 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(trainsp2, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-20" aria-hidden="true" tabindex="-1"></a>fcnSP2010 <span class="ot">&lt;-</span> <span class="fu">naive</span>(trainsp2, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-21" aria-hidden="true" tabindex="-1"></a>fcdSP2010 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(trainsp2, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Price Index Forecasts</span></span>
<span id="cb65-24"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-24" aria-hidden="true" tabindex="-1"></a>fcmFTSE2010 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(FTSEtrain2, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-25"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-25" aria-hidden="true" tabindex="-1"></a>fcnFTSE2010 <span class="ot">&lt;-</span> <span class="fu">naive</span>(FTSEtrain2, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-26"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-26" aria-hidden="true" tabindex="-1"></a>fcdFTSE2010 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(FTSEtrain2, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-27"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Forecasts for the year 2020 ----</span></span>
<span id="cb65-29"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-30"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 Forecasts</span></span>
<span id="cb65-31"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-31" aria-hidden="true" tabindex="-1"></a>fcmSP2020 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(trainsp3, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-32"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-32" aria-hidden="true" tabindex="-1"></a>fcnSP2020 <span class="ot">&lt;-</span> <span class="fu">naive</span>(trainsp3, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-33"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-33" aria-hidden="true" tabindex="-1"></a>fcdSP2020 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(trainsp3, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-34"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-35"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-35" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Price Index Forecasts</span></span>
<span id="cb65-36"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-36" aria-hidden="true" tabindex="-1"></a>fcmFTSE2020 <span class="ot">&lt;-</span> <span class="fu">meanf</span>(FTSEtrain3, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-37"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-37" aria-hidden="true" tabindex="-1"></a>fcnFTSE2020 <span class="ot">&lt;-</span> <span class="fu">naive</span>(FTSEtrain3, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span>
<span id="cb65-38"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb65-38" aria-hidden="true" tabindex="-1"></a>fcdFTSE2020 <span class="ot">&lt;-</span> <span class="fu">rwf</span>(FTSEtrain3, <span class="at">drift=</span><span class="cn">TRUE</span>, <span class="at">h=</span><span class="dv">24</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First plot for S&amp;P 500 ending in 2000</span></span>
<span id="cb66-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp1) <span class="sc">+</span></span>
<span id="cb66-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcmSP2000, <span class="at">series=</span><span class="st">"Mean"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span>  <span class="co"># Reduced opacity for forecasts</span></span>
<span id="cb66-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcnSP2000, <span class="at">series=</span><span class="st">"Naive"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>,<span class="at">size=</span><span class="fl">1.2</span> ) <span class="sc">+</span></span>
<span id="cb66-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcdSP2000, <span class="at">series=</span><span class="st">"Drift"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb66-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP1, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Emphasize actual data</span></span>
<span id="cb66-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">"S&amp;P 500 Price"</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span> </span>
<span id="cb66-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb66-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price Simple Forecast Ending 2000'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Second plot for S&amp;P 500 ending in 2010</span></span>
<span id="cb67-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp2) <span class="sc">+</span></span>
<span id="cb67-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcmSP2010, <span class="at">series=</span><span class="st">"Mean"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb67-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcnSP2010, <span class="at">series=</span><span class="st">"Naive"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb67-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcdSP2010, <span class="at">series=</span><span class="st">"Drift"</span>, <span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb67-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(SP2, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">"S&amp;P 500 Price"</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb67-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price Simple Forecast Ending 2010'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Third plot for S&amp;P 500 ending in 2020 - Corrected</span></span>
<span id="cb68-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp3)  <span class="sc">+</span></span>
<span id="cb68-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcmSP2020, <span class="at">series=</span><span class="st">"Mean"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span>  </span>
<span id="cb68-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcnSP2020, <span class="at">series=</span><span class="st">"Naive"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb68-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcdSP2020, <span class="at">series=</span><span class="st">"Drift"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP3, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>, <span class="at">color=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb68-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">"S&amp;P 500 Price"</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb68-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price Simple Forecast Ending 2020'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain1) <span class="sc">+</span></span>
<span id="cb69-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb69-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcmFTSE2000, <span class="at">series=</span><span class="st">"Mean"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb69-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb69-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcnFTSE2000, <span class="at">series=</span><span class="st">"Naive"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb69-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb69-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcdFTSE2000, <span class="at">series=</span><span class="st">"Drift"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb69-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(FTSE1, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">"FTSE INDEX PRICE"</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb69-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price Simple Forecast Ending 2000'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain2) <span class="sc">+</span></span>
<span id="cb70-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb70-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcmFTSE2010, <span class="at">series=</span><span class="st">"Mean"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb70-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb70-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcnFTSE2010, <span class="at">series=</span><span class="st">"Naive"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb70-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb70-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcdFTSE2010, <span class="at">series=</span><span class="st">"Drift"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb70-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(FTSE2, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb70-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">"FTSE INDEX PRICE"</span>, <span class="at">col=</span><span class="st">"Forecast"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span> </span>
<span id="cb70-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price Simple Forecast Ending 2010'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain3) <span class="sc">+</span></span>
<span id="cb71-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-2" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb71-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcmFTSE2020, <span class="at">series=</span><span class="st">"Mean"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb71-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcnFTSE2020, <span class="at">series=</span><span class="st">"Naive"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb71-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">autolayer</span>(fcdFTSE2020, <span class="at">series=</span><span class="st">"Drift"</span>,<span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(FTSE3, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb71-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">"FTSE INDEX PRICE"</span>, <span class="at">col=</span><span class="st">"Forecast"</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()<span class="sc">+</span> </span>
<span id="cb71-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"FTSE Index Price Simple Forecast Ending 2020"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the above plots of the FTSE Price Index and S&amp;P 500 Index forecasts over the three time horizons ending in 2000, 2010, and 2020, and using three different forecasting methods—Mean, Naive, and Drift (from a Random Walk Forecast)—we can evaluate the forecasting results.</p>
<p><strong>FTSE Price Index Forecast Evaluation:</strong></p>
<p><strong>Forecast Ending in 2000:</strong></p>
<ul>
<li><p>The FTSE Index experienced a generally upward trend during the 90s, which the Drift method attempts to capture by including a trend component in the forecast. This seems to provide a closer match to the actual data compared to the Mean and Naive methods.</p></li>
<li><p>The Mean forecast underestimates future values as it does not account for the upward trend.</p></li>
<li><p>The Naive forecast appears to follow the trend of the actual data in the short run but fails to anticipate longer-term shifts as it only uses the last observed value for forecasting.</p></li>
</ul>
<p><strong>Forecast Ending in 2010:</strong></p>
<ul>
<li><p>The period leading up to 2010 includes the 2008 financial crisis, which is reflected as a sharp drop in the FTSE Index. None of the methods capture this downturn, which is a limitation of simple forecasting techniques that cannot account for such abrupt economic changes.</p></li>
<li><p>The Drift method again follows the trend but fails to account for the volatility associated with the financial crisis.</p></li>
<li><p>The Mean and Naive forecasts do not capture the economic downturn and its recovery, showing the limitations of these methods in volatile markets.</p></li>
</ul>
<p><strong>Forecast Ending in 2020:</strong></p>
<ul>
<li><p>The recovery post-2008 crisis and subsequent growth up until 2020 are somewhat captured by the Drift method, although it fails to model any shorter-term fluctuations.</p></li>
<li><p>The Mean method appears to be too static and not responsive to actual changes in the market conditions.</p></li>
<li><p>The Naive method, while capturing some of the movement, still cannot anticipate the direction or magnitude of change effectively.</p></li>
</ul>
<p><strong>S&amp;P 500 Index Forecast Evaluation:</strong></p>
<p><strong>Forecast Ending in 2000:</strong></p>
<ul>
<li><p>The S&amp;P 500 Index plot exhibits an upward trend similar to the FTSE, and the observations regarding the forecasting methods are analogous.</p></li>
<li><p>The Drift method aligns closest to the actual index, considering the upward momentum.</p></li>
<li><p>Both the Mean and Naive methods underestimate the index’s performance.</p></li>
</ul>
<p><strong>Forecast Ending in 2010:</strong></p>
<ul>
<li><p>As with the FTSE, the S&amp;P 500 forecast does not capture the 2008 crisis.</p></li>
<li><p>Post-crisis recovery is somewhat anticipated by the Drift method, but none of the methods effectively model the depth of the crisis.</p></li>
</ul>
<p><strong>Forecast Ending in 2020:</strong></p>
<ul>
<li><p>The Drift method follows the post-recovery upward trend relatively well but cannot anticipate the onset of the COVID-19 pandemic in early 2020 and the associated market upheaval.</p></li>
<li><p>Mean and Naive methods continue to show limitations in forecasting over a horizon with significant economic events.</p></li>
</ul>
<section id="comparative-insights" class="level3">
<h3 class="anchored" data-anchor-id="comparative-insights"><strong>Comparative Insights:</strong><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#comparative-insights" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<ul>
<li><p>Across both indices and all time horizons, the Drift method provides a better forecast when a clear trend is present in the historical data. However, it is not effective in anticipating sharp, unexpected turns in the market.</p></li>
<li><p>The Mean forecast method is less effective in dynamic markets as it assumes average conditions persist, making it unable to anticipate trends or changes in volatility.</p></li>
<li><p>The Naive method is only effective in very short-term forecasts and in stable market conditions, as it assumes the last observed value continues forward.</p></li>
<li><p>None of the methods are sufficient on their own to capture complex market dynamics, especially during times of economic upheaval. For such environments, more sophisticated models or the inclusion of external variables might be necessary.</p></li>
</ul>
<p>In conclusion, while simple forecasting methods can be a starting point for understanding general trends, their limitations are apparent in the face of market volatility and significant economic events. They serve as a baseline for comparison with more complex models that can potentially offer better accuracy by incorporating additional data and market dynamics.</p>
<p><strong>MOVING AVERAGE FORECAST</strong></p>
<p>The provided R code performs a 2nd-order moving average (2OMA) calculation and subsequent forecasting for the S&amp;P 500 and FTSE indices at three different time points: ending in the years 2000, 2010, and 2020. The forecasts project the next 24 periods based on these moving averages. The ma() function calculates the 2nd-order moving average for given time series data (trainsp1, FTSEtrain1, etc.). The order parameter is set to 2, meaning the moving average is calculated over two periods. The centre parameter is FALSE, indicating that the averaging is not centered around the middle of the two periods.The forecast() function is then used to predict the next 24 periods based on the calculated moving averages.This process is repeated for the S&amp;P 500 and FTSE indices for three distinct time periods, indicating an analysis for different stages or cycles within the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading necessary libraries</span></span>
<span id="cb72-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># Ensure the forecast package is loaded for ma() and forecast() functions</span></span>
<span id="cb72-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining moving average and forecasting for three time points (2000, 2010, 2020)</span></span>
<span id="cb72-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for both the S&amp;P 500 and FTSE indices.</span></span>
<span id="cb72-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2000 Forecasts</span></span>
<span id="cb72-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 - Calculating 2nd-Order Moving Average and Forecast</span></span>
<span id="cb72-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-9" aria-hidden="true" tabindex="-1"></a>SP_2000_2OMA <span class="ot">&lt;-</span> <span class="fu">ma</span>(trainsp1, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">centre =</span> <span class="cn">FALSE</span>) <span class="co"># Calculate the moving average</span></span>
<span id="cb72-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb72-10" aria-hidden="true" tabindex="-1"></a>SP_2000_2OMAf <span class="ot">&lt;-</span> <span class="fu">forecast</span>(SP_2000_2OMA, <span class="at">h =</span> <span class="dv">24</span>) <span class="co"># Forecast next 24 periods</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ets(object, lambda = lambda, biasadj = biasadj,
allow.multiplicative.trend = allow.multiplicative.trend, : Missing values
encountered. Using longest contiguous portion of time series</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE - Calculating 2nd-Order Moving Average and Forecast</span></span>
<span id="cb74-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb74-2" aria-hidden="true" tabindex="-1"></a>FTSE_2000_2OMA <span class="ot">&lt;-</span> <span class="fu">ma</span>(FTSEtrain1, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">centre =</span> <span class="cn">FALSE</span>) <span class="co"># Calculate the moving average</span></span>
<span id="cb74-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb74-3" aria-hidden="true" tabindex="-1"></a>FTSE_2000_2OMAf <span class="ot">&lt;-</span> <span class="fu">forecast</span>(FTSE_2000_2OMA, <span class="at">h =</span> <span class="dv">24</span>) <span class="co"># Forecast next 24 periods</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ets(object, lambda = lambda, biasadj = biasadj,
allow.multiplicative.trend = allow.multiplicative.trend, : Missing values
encountered. Using longest contiguous portion of time series</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2010 Forecasts</span></span>
<span id="cb76-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 - Calculating 2nd-Order Moving Average and Forecast</span></span>
<span id="cb76-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb76-3" aria-hidden="true" tabindex="-1"></a>SP_2010_2OMA <span class="ot">&lt;-</span> <span class="fu">ma</span>(trainsp2, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">centre =</span> <span class="cn">FALSE</span>) <span class="co"># Calculate the moving average</span></span>
<span id="cb76-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb76-4" aria-hidden="true" tabindex="-1"></a>SP_2010_2OMAf <span class="ot">&lt;-</span> <span class="fu">forecast</span>(SP_2010_2OMA, <span class="at">h =</span> <span class="dv">24</span>) <span class="co"># Forecast next 24 periods</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ets(object, lambda = lambda, biasadj = biasadj,
allow.multiplicative.trend = allow.multiplicative.trend, : Missing values
encountered. Using longest contiguous portion of time series</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE - Calculating 2nd-Order Moving Average and Forecast</span></span>
<span id="cb78-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb78-2" aria-hidden="true" tabindex="-1"></a>FTSE_2010_2OMA <span class="ot">&lt;-</span> <span class="fu">ma</span>(FTSEtrain2, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">centre =</span> <span class="cn">FALSE</span>) <span class="co"># Calculate the moving average</span></span>
<span id="cb78-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb78-3" aria-hidden="true" tabindex="-1"></a>FTSE_2010_2OMAf <span class="ot">&lt;-</span> <span class="fu">forecast</span>(FTSE_2010_2OMA, <span class="at">h =</span> <span class="dv">24</span>) <span class="co"># Forecast next 24 periods</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ets(object, lambda = lambda, biasadj = biasadj,
allow.multiplicative.trend = allow.multiplicative.trend, : Missing values
encountered. Using longest contiguous portion of time series</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020 Forecasts</span></span>
<span id="cb80-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 - Calculating 2nd-Order Moving Average and Forecast</span></span>
<span id="cb80-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb80-3" aria-hidden="true" tabindex="-1"></a>SP_2020_2OMA <span class="ot">&lt;-</span> <span class="fu">ma</span>(trainsp3, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">centre =</span> <span class="cn">FALSE</span>) <span class="co"># Calculate the moving average</span></span>
<span id="cb80-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb80-4" aria-hidden="true" tabindex="-1"></a>SP_2020_2OMAf <span class="ot">&lt;-</span> <span class="fu">forecast</span>(SP_2020_2OMA, <span class="at">h =</span> <span class="dv">24</span>) <span class="co"># Forecast next 24 periods</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ets(object, lambda = lambda, biasadj = biasadj,
allow.multiplicative.trend = allow.multiplicative.trend, : Missing values
encountered. Using longest contiguous portion of time series</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE - Calculating 2nd-Order Moving Average and Forecast</span></span>
<span id="cb82-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb82-2" aria-hidden="true" tabindex="-1"></a>FTSE_2020_2OMA <span class="ot">&lt;-</span> <span class="fu">ma</span>(FTSEtrain3, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">centre =</span> <span class="cn">FALSE</span>) <span class="co"># Calculate the moving average</span></span>
<span id="cb82-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb82-3" aria-hidden="true" tabindex="-1"></a>FTSE_2020_2OMAf <span class="ot">&lt;-</span> <span class="fu">forecast</span>(FTSE_2020_2OMA, <span class="at">h =</span> <span class="dv">24</span>) <span class="co"># Forecast next 24 periods</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ets(object, lambda = lambda, biasadj = biasadj,
allow.multiplicative.trend = allow.multiplicative.trend, : Missing values
encountered. Using longest contiguous portion of time series</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb84-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># For forecasting functions</span></span>
<span id="cb84-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="co"># For plotting</span></span>
<span id="cb84-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fpp2)     <span class="co"># Assuming this is used for 'autoplot' with time series</span></span>
<span id="cb84-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing S&amp;P 500 index price movements, 2-MA, and 2-MA forecasts for three periods</span></span>
<span id="cb84-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for the period ending in 2000</span></span>
<span id="cb84-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp1) <span class="sc">+</span>  <span class="co"># Base plot from the first time series dataset</span></span>
<span id="cb84-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP_2000_2OMA, <span class="at">series =</span> <span class="st">'2-MA'</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add 2-MA layer</span></span>
<span id="cb84-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP1, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add actual price movements layer</span></span>
<span id="cb84-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">autolayer</span>(SP_2000_2OMAf, <span class="at">series=</span><span class="st">"2-MA-Forecast"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add 2-MA forecast layer</span></span>
<span id="cb84-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'SP500 Index Price'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="co"># Set labels</span></span>
<span id="cb84-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb84-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price Moving Average Ending 2000'</span>) <span class="co"># Set plot title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for the period ending in 2010</span></span>
<span id="cb86-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp2) <span class="sc">+</span>  <span class="co"># Base plot from the second time series dataset</span></span>
<span id="cb86-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP_2010_2OMAf, <span class="at">series=</span><span class="st">"2-MA-Forecast"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add 2-MA forecast layer</span></span>
<span id="cb86-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP_2010_2OMA, <span class="at">series =</span> <span class="st">'2-MA'</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add 2-MA layer</span></span>
<span id="cb86-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP2, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add actual price movements layer</span></span>
<span id="cb86-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'SP500 Index Price'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="co"># Set labels</span></span>
<span id="cb86-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb86-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price Moving Average Ending 2010'</span>) <span class="co"># Set plot title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for the period ending in 2020</span></span>
<span id="cb88-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp3) <span class="sc">+</span>  <span class="co"># Base plot from the third time series dataset</span></span>
<span id="cb88-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP_2020_2OMAf, <span class="at">series=</span><span class="st">"2-MA-Forecast"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add 2-MA forecast layer</span></span>
<span id="cb88-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP_2020_2OMA, <span class="at">series =</span> <span class="st">'2-MA'</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add 2-MA layer</span></span>
<span id="cb88-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP3, <span class="at">series=</span><span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Add actual price movements layer</span></span>
<span id="cb88-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'SP500 Index Price'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="co"># Set labels</span></span>
<span id="cb88-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb88-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price Moving Average Ending 2020'</span>) <span class="co"># Set plot title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensuring necessary libraries are loaded</span></span>
<span id="cb90-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># For time series forecasting</span></span>
<span id="cb90-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="co"># For plotting capabilities</span></span>
<span id="cb90-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of FTSE Index Prices with 2nd-Order Moving Averages</span></span>
<span id="cb90-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index - Ending in 2000</span></span>
<span id="cb90-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain1) <span class="sc">+</span> </span>
<span id="cb90-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE_2000_2OMAf, <span class="at">series =</span> <span class="st">"2-MA-Forecast"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the 2-MA forecast</span></span>
<span id="cb90-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE_2000_2OMA, <span class="at">series =</span> <span class="st">'2-MA'</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the 2-MA calculations</span></span>
<span id="cb90-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE1, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay actual price movements</span></span>
<span id="cb90-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'FTSE Index Price'</span>, <span class="at">col =</span> <span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="co"># Customize labels</span></span>
<span id="cb90-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price Moving Average Ending 2000'</span>) <span class="sc">+</span> <span class="co"># Add a plot title</span></span>
<span id="cb90-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="co"># Use a minimalistic theme for a clean look</span></span>
<span id="cb90-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb90-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="co"># Center the plot title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index - Ending in 2010</span></span>
<span id="cb92-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain2) <span class="sc">+</span> </span>
<span id="cb92-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE_2010_2OMAf, <span class="at">series =</span> <span class="st">"2-MA-Forecast"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the 2-MA forecast</span></span>
<span id="cb92-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE_2010_2OMA, <span class="at">series =</span> <span class="st">'2-MA'</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the 2-MA calculations</span></span>
<span id="cb92-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE2, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay actual price movements</span></span>
<span id="cb92-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'FTSE Index Price'</span>, <span class="at">col =</span> <span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="co"># Customize labels</span></span>
<span id="cb92-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price Moving Average Ending 2010'</span>) <span class="sc">+</span> <span class="co"># Add a plot title</span></span>
<span id="cb92-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="co"># Use a minimalistic theme for a clean look</span></span>
<span id="cb92-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="co"># Center the plot title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index - Ending in 2020</span></span>
<span id="cb94-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain3) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE_2020_2OMAf, <span class="at">series =</span> <span class="st">"2-MA-Forecast"</span>,<span class="at">alpha=</span><span class="fl">0.2</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the 2-MA forecast</span></span>
<span id="cb94-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE_2020_2OMA, <span class="at">series =</span> <span class="st">'2-MA'</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the 2-MA calculations</span></span>
<span id="cb94-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE3, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay actual price movements</span></span>
<span id="cb94-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'FTSE Index Price'</span>, <span class="at">col =</span> <span class="st">"Forecast"</span>) <span class="sc">+</span> <span class="co"># Customize labels</span></span>
<span id="cb94-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price Moving Average Ending 2020'</span>) <span class="sc">+</span> <span class="co"># Add a plot title</span></span>
<span id="cb94-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="co"># Use a minimalistic theme for a clean look</span></span>
<span id="cb94-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="co"># Center the plot title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-16-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>ACCURACY</strong>: The provided code calculates the Root Mean Square Error (RMSE) for forecasts of the S&amp;P 500 and FTSE indices for two different periods (assumed to be for years ending in 2000 and 2010, despite the naming conventions suggesting otherwise). It then constructs a matrix to organize these RMSE values, converts the matrix to a table for easier reading, and prints the result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the Metrics package is installed and loaded</span></span>
<span id="cb96-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb96-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate RMSE, MAE, and MAPE</span></span>
<span id="cb96-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-5" aria-hidden="true" tabindex="-1"></a>calc_accuracy_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(actual, forecast) {</span>
<span id="cb96-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure forecast length matches actual data length</span></span>
<span id="cb96-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(forecast) <span class="sc">!=</span> <span class="fu">length</span>(actual)) {</span>
<span id="cb96-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-8" aria-hidden="true" tabindex="-1"></a>    forecast <span class="ot">&lt;-</span> forecast[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(actual)]</span>
<span id="cb96-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-11" aria-hidden="true" tabindex="-1"></a>  rmse_val <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((forecast <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb96-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-12" aria-hidden="true" tabindex="-1"></a>  mae_val <span class="ot">&lt;-</span> <span class="fu">mae</span>(actual, forecast)</span>
<span id="cb96-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-13" aria-hidden="true" tabindex="-1"></a>  mape_val <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(forecast <span class="sc">-</span> actual) <span class="sc">/</span> <span class="fu">abs</span>(actual), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb96-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">RMSE =</span> rmse_val, <span class="at">MAE =</span> mae_val, <span class="at">MAPE =</span> mape_val))</span>
<span id="cb96-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing actual data as numeric vectors and adjust forecast lengths</span></span>
<span id="cb96-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-19" aria-hidden="true" tabindex="-1"></a>actual_SP1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SP1)</span>
<span id="cb96-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-20" aria-hidden="true" tabindex="-1"></a>actual_SP2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SP2)</span>
<span id="cb96-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-21" aria-hidden="true" tabindex="-1"></a>actual_SP3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(SP3)</span>
<span id="cb96-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-22" aria-hidden="true" tabindex="-1"></a>actual_FTSE1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(FTSE1)</span>
<span id="cb96-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-23" aria-hidden="true" tabindex="-1"></a>actual_FTSE2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(FTSE2)</span>
<span id="cb96-24"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-24" aria-hidden="true" tabindex="-1"></a>actual_FTSE3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(FTSE3)</span>
<span id="cb96-25"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-26"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating accuracy metrics, ensuring forecast lengths match actual data lengths</span></span>
<span id="cb96-27"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-27" aria-hidden="true" tabindex="-1"></a>metrics_SP_2000 <span class="ot">&lt;-</span> <span class="fu">calc_accuracy_metrics</span>(actual_SP1, SP_2000_2OMAf<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(SP1)])</span>
<span id="cb96-28"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-28" aria-hidden="true" tabindex="-1"></a>metrics_SP_2010 <span class="ot">&lt;-</span> <span class="fu">calc_accuracy_metrics</span>(actual_SP2, SP_2010_2OMAf<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(SP2)])</span>
<span id="cb96-29"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-29" aria-hidden="true" tabindex="-1"></a>metrics_SP_2020 <span class="ot">&lt;-</span> <span class="fu">calc_accuracy_metrics</span>(actual_SP3, SP_2020_2OMAf<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(SP3)])</span>
<span id="cb96-30"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-31"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-31" aria-hidden="true" tabindex="-1"></a>metrics_FTSE_2000 <span class="ot">&lt;-</span> <span class="fu">calc_accuracy_metrics</span>(actual_FTSE1, FTSE_2000_2OMAf<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(FTSE1)])</span>
<span id="cb96-32"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-32" aria-hidden="true" tabindex="-1"></a>metrics_FTSE_2010 <span class="ot">&lt;-</span> <span class="fu">calc_accuracy_metrics</span>(actual_FTSE2, FTSE_2010_2OMAf<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(FTSE2)])</span>
<span id="cb96-33"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-33" aria-hidden="true" tabindex="-1"></a>metrics_FTSE_2020 <span class="ot">&lt;-</span> <span class="fu">calc_accuracy_metrics</span>(actual_FTSE3, FTSE_2020_2OMAf<span class="sc">$</span>mean[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(FTSE3)])</span>
<span id="cb96-34"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-35"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining all accuracy metrics into a single data frame</span></span>
<span id="cb96-36"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-36" aria-hidden="true" tabindex="-1"></a>accuracy_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb96-37"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"S&amp;P"</span>, <span class="st">"FTSE"</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb96-38"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">Time_Horizon =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"2000"</span>, <span class="st">"2010"</span>, <span class="st">"2020"</span>), <span class="dv">2</span>),</span>
<span id="cb96-39"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">c</span>(metrics_SP_2000[<span class="st">"RMSE"</span>], metrics_SP_2010[<span class="st">"RMSE"</span>], metrics_SP_2020[<span class="st">"RMSE"</span>],</span>
<span id="cb96-40"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-40" aria-hidden="true" tabindex="-1"></a>           metrics_FTSE_2000[<span class="st">"RMSE"</span>], metrics_FTSE_2010[<span class="st">"RMSE"</span>], metrics_FTSE_2020[<span class="st">"RMSE"</span>]),</span>
<span id="cb96-41"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> <span class="fu">c</span>(metrics_SP_2000[<span class="st">"MAE"</span>], metrics_SP_2010[<span class="st">"MAE"</span>], metrics_SP_2020[<span class="st">"MAE"</span>],</span>
<span id="cb96-42"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-42" aria-hidden="true" tabindex="-1"></a>          metrics_FTSE_2000[<span class="st">"MAE"</span>], metrics_FTSE_2010[<span class="st">"MAE"</span>], metrics_FTSE_2020[<span class="st">"MAE"</span>]),</span>
<span id="cb96-43"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAPE =</span> <span class="fu">c</span>(metrics_SP_2000[<span class="st">"MAPE"</span>], metrics_SP_2010[<span class="st">"MAPE"</span>], metrics_SP_2020[<span class="st">"MAPE"</span>],</span>
<span id="cb96-44"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-44" aria-hidden="true" tabindex="-1"></a>           metrics_FTSE_2000[<span class="st">"MAPE"</span>], metrics_FTSE_2010[<span class="st">"MAPE"</span>], metrics_FTSE_2020[<span class="st">"MAPE"</span>])</span>
<span id="cb96-45"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-46"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-47"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb96-48"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb96-48" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(accuracy_results, <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">caption =</span> <span class="st">"Accuracy Metrics for Moving Averages Forecasts"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Table: Accuracy Metrics for Moving Averages Forecasts

|Index |Time_Horizon |     RMSE| MAE|      MAPE|
|:-----|:------------|--------:|---:|---------:|
|S&amp;P   |2000         | 254.9292|  NA| 0.1741050|
|S&amp;P   |2010         | 340.7512|  NA| 0.2775335|
|S&amp;P   |2020         | 253.2135|  NA| 0.0804015|
|FTSE  |2000         | 507.9728|  NA| 0.1640550|
|FTSE  |2010         | 590.9151|  NA| 0.1863163|
|FTSE  |2020         | 414.4010|  NA| 0.0960014|</code></pre>
</div>
</div>
<section id="analysis-of-moving-average-forecasts-for-sp-500-and-ftse-indices" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-moving-average-forecasts-for-sp-500-and-ftse-indices"><strong>Analysis of Moving Average Forecasts for S&amp;P 500 and FTSE Indices</strong><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#analysis-of-moving-average-forecasts-for-sp-500-and-ftse-indices" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<p>Analyzing the performance of moving average forecast against the actual price movements of the S&amp;P 500 and FTSE indices over the three distinct time horizons provides, the results from the RMSE, MAE, and MAPE tests present a quantitative measure of forecast accuracy, while the plots offer a qualitative perspective on how the forecasts align with actual price movements.</p>
<p><strong>FTSE Index Price Moving Average Forecasts:</strong></p>
<p><strong>Ending 2000:</strong></p>
<ul>
<li><p>The FTSE forecast for 2000 suggests an optimistic scenario where the moving average predicts an upward trend. However, the RMSE and MAE indicate significant average errors, implying that the forecast may not have captured the nuances of the market movements.</p></li>
<li><p>The MAPE value indicates that, on average, the forecast errors are about 16% of the actual values, which is substantial but may be considered acceptable for long-term strategic decisions.</p></li>
</ul>
<p><strong>Ending 2010:</strong></p>
<ul>
<li><p>The forecast did not anticipate the severity of the 2008 financial crisis and subsequent recovery. This oversight is reflected in higher RMSE and MAE values compared to the 2000 forecast.</p></li>
<li><p>The MAPE value shows an increase from the 2000 forecast, indicating that the forecast’s percentage error relative to actual values has grown, which is a testament to the increasing market volatility and unpredictability.</p></li>
</ul>
<p><strong>Ending 2020:</strong></p>
<ul>
<li><p>The forecast captures the general upward trend but not the volatility within the decade, especially considering the impact of the COVID-19 pandemic in early 2020.</p></li>
<li><p>The RMSE and MAE are lower compared to the 2010 forecast, but they still present considerable errors. The reduced MAPE suggests a relatively better forecast performance, yet this may be due to the higher price levels which diminish the percentage error.</p></li>
</ul>
<p><strong>S&amp;P 500 Index Price Moving Average Forecasts:</strong></p>
<p><strong>Ending 2000:</strong></p>
<ul>
<li><p>Similar to the FTSE, the moving average forecast for the S&amp;P 500 exhibits an optimistic trend continuing the bull market of the 1990s, but the RMSE and MAE values reveal notable discrepancies.</p></li>
<li><p>The MAPE value indicates the forecast’s errors are substantial in the context of the dot-com bubble’s burst around 2000.</p></li>
</ul>
<p><strong>Ending 2010:</strong></p>
<ul>
<li>As with the FTSE, the forecast failed to capture the 2008 downturn, resulting in higher error metrics than the 2000 forecast. The MAPE value reflects a significant increase, highlighting the forecast’s inability to adjust to the dramatic market shifts during the financial crisis.</li>
</ul>
<p><strong>Ending 2020:</strong></p>
<ul>
<li>The forecast reflects a bullish trend, which aligns with the actual S&amp;P 500 trend until the pandemic-induced volatility. The errors remain significant, as indicated by RMSE and MAE, yet the MAPE is considerably lower, suggesting that while the forecast wasn’t precise, its relative error was smaller given the higher actual index values.</li>
</ul>
<p><strong>Comparative Insights:</strong></p>
<ul>
<li><p>Across both indices, the forecasts are more accurate for stable periods with less market turmoil. As the market enters more turbulent times, such as during financial crises or unexpected global events, the moving average forecasts become less reliable.</p></li>
<li><p>The moving average method has inherent lag, as it relies on past data. This makes it less responsive to sudden market shifts, resulting in larger forecast errors during periods of significant change.</p></li>
<li><p>The MAPE tends to be lower in higher-value index scenarios since the error constitutes a smaller percentage of the higher actual values.</p></li>
<li><p>While the moving average method captures long-term trends to some extent, it’s clear that for more accurate and responsive forecasts, especially in volatile markets, more sophisticated models are necessary.</p></li>
</ul>
<p>In conclusion, the moving average model provides a baseline forecast that’s more suited for stable and less volatile periods. Its utility diminishes in the face of abrupt market shifts and high volatility. Future forecasts could benefit from incorporating additional indicators or employing more advanced time-series models that can account for changes in market dynamics and external shocks.</p>
</section>
<section id="exponential-smoothing-forecasting" class="level4">
<h4 class="anchored" data-anchor-id="exponential-smoothing-forecasting"><strong>EXPONENTIAL SMOOTHING FORECASTING</strong><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#exponential-smoothing-forecasting" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<p>The primary goal is to predict future values of the S&amp;P and FTSE indices for the next 24 periods (assumed to be months in this context) based on historical data up to the years 2000, 2010, and 2020.By applying SES to these time series data, the code aims to analyze the temporal structure of the indices and produce smoothed forecasts. This is particularly useful for financial time series that exhibit trends or patterns over time.The SES method applies exponential smoothing to the time series data, giving more weight to the most recent observations while exponentially decreasing the weights for older observations. This method is particularly effective for forecasting when the series does not exhibit strong trend or seasonal patterns.Applying SES to financial indices like the S&amp;P and FTSE allows analysts and investors to understand potential future movements based on historical trends. While SES provides a straightforward and quick forecasting method, it’s essential to consider its assumptions and limitations, especially in the complex and often volatile context of financial markets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying Simple Exponential Smoothing (SES) to forecast future values </span></span>
<span id="cb98-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for the S&amp;P and FTSE indices for three different periods: 2000, 2010, and 2020.</span></span>
<span id="cb98-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading necessary library for SES and forecasting</span></span>
<span id="cb98-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb98-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting for the year 2000</span></span>
<span id="cb98-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P Index Forecast Using SES</span></span>
<span id="cb98-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-9" aria-hidden="true" tabindex="-1"></a>fcsesSP2000 <span class="ot">&lt;-</span> <span class="fu">ses</span>(trainsp1, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Apply SES on S&amp;P data for period ending in 2000, forecast next 24 periods</span></span>
<span id="cb98-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index Forecast Using SES</span></span>
<span id="cb98-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-11" aria-hidden="true" tabindex="-1"></a>fcsesFTSE2000 <span class="ot">&lt;-</span> <span class="fu">ses</span>(FTSEtrain1, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Apply SES on FTSE data for period ending in 2000, forecast next 24 periods</span></span>
<span id="cb98-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting for the year 2010</span></span>
<span id="cb98-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P Index Forecast Using SES</span></span>
<span id="cb98-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-15" aria-hidden="true" tabindex="-1"></a>fcsesSP2010 <span class="ot">&lt;-</span> <span class="fu">ses</span>(trainsp2, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Apply SES on S&amp;P data for period ending in 2010, forecast next 24 periods</span></span>
<span id="cb98-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index Forecast Using SES</span></span>
<span id="cb98-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-17" aria-hidden="true" tabindex="-1"></a>fcsesFTSE2010 <span class="ot">&lt;-</span> <span class="fu">ses</span>(FTSEtrain2, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Apply SES on FTSE data for period ending in 2010, forecast next 24 periods</span></span>
<span id="cb98-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting for the year 2020</span></span>
<span id="cb98-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P Index Forecast Using SES</span></span>
<span id="cb98-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-21" aria-hidden="true" tabindex="-1"></a>fcsesSP2020 <span class="ot">&lt;-</span> <span class="fu">ses</span>(trainsp3, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Apply SES on S&amp;P data for period ending in 2020, forecast next 24 periods</span></span>
<span id="cb98-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index Forecast Using SES</span></span>
<span id="cb98-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb98-23" aria-hidden="true" tabindex="-1"></a>fcsesFTSE2020 <span class="ot">&lt;-</span> <span class="fu">ses</span>(FTSEtrain3, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Apply SES on FTSE data for period ending in 2020, forecast next 24 periods</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#S&amp;P 500 Exponential Smoothing Forecasting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing SES Forecasts and Actual Price Movements for the S&amp;P 500 Index</span></span>
<span id="cb99-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb99-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast) <span class="co"># For SES forecasting functions</span></span>
<span id="cb99-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="co"># For plotting</span></span>
<span id="cb99-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 Index Price Visualization for the Period Ending in 2000</span></span>
<span id="cb99-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp1) <span class="sc">+</span> </span>
<span id="cb99-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcsesSP2000, <span class="at">series =</span> <span class="st">"SES Forecast"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the SES forecast</span></span>
<span id="cb99-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP1, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay actual price movements</span></span>
<span id="cb99-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'S&amp;P 500 Index Price'</span>, <span class="at">col =</span> <span class="st">"Series"</span>) <span class="sc">+</span> <span class="co"># Customize axis labels and legend title</span></span>
<span id="cb99-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price: SES Forecast vs. Actual (Ending 2000)'</span>) <span class="sc">+</span> <span class="co"># Add a descriptive title</span></span>
<span id="cb99-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="co"># Use a minimal theme for a clean look</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 Index Price Visualization for the Period Ending in 2010</span></span>
<span id="cb100-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp2) <span class="sc">+</span> </span>
<span id="cb100-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcsesSP2010, <span class="at">series =</span> <span class="st">"SES Forecast"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the SES forecast</span></span>
<span id="cb100-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP2, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay actual price movements</span></span>
<span id="cb100-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'S&amp;P 500 Index Price'</span>, <span class="at">col =</span> <span class="st">"Series"</span>) <span class="sc">+</span> <span class="co"># Customize axis labels and legend title</span></span>
<span id="cb100-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price: SES Forecast vs. Actual (Ending 2010)'</span>) <span class="sc">+</span> <span class="co"># Add a descriptive title</span></span>
<span id="cb100-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="co"># Use a minimal theme for a clean look</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-19-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P 500 Index Price Visualization for the Period Ending in 2020</span></span>
<span id="cb101-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp3) <span class="sc">+</span> </span>
<span id="cb101-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcsesSP2020, <span class="at">series =</span> <span class="st">"SES Forecast"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the SES forecast</span></span>
<span id="cb101-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP3, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay actual price movements</span></span>
<span id="cb101-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'S&amp;P 500 Index Price'</span>, <span class="at">col =</span> <span class="st">"Series"</span>) <span class="sc">+</span> <span class="co"># Customize axis labels and legend title</span></span>
<span id="cb101-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 Index Price: SES Forecast vs. Actual (Ending 2020)'</span>) <span class="sc">+</span> <span class="co"># Add a descriptive title</span></span>
<span id="cb101-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="co"># Use a minimal theme for a clean look</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-19-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>#FTSE EXPONENTIAL SMOOTHING FORECASTING- FTSE PRICE INDEX</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing SES Forecasts and Actual Price Movements for the FTSE Index</span></span>
<span id="cb102-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading necessary libraries for plotting and forecasting</span></span>
<span id="cb102-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb102-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb102-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index Price Visualization for the Period Ending in 2000</span></span>
<span id="cb102-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain1) <span class="sc">+</span> </span>
<span id="cb102-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcsesFTSE2000, <span class="at">series =</span> <span class="st">"SES Forecast"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay the SES forecast with specified color</span></span>
<span id="cb102-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE1, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> <span class="co"># Overlay actual price movements with specified color</span></span>
<span id="cb102-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'FTSE Index Price'</span>, <span class="at">col =</span> <span class="st">"Series"</span>) <span class="sc">+</span> <span class="co"># Customize axis labels and legend title</span></span>
<span id="cb102-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price: SES Forecast vs. Actual (Ending 2000)'</span>) <span class="sc">+</span> <span class="co"># Add a descriptive title</span></span>
<span id="cb102-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span> <span class="co"># Use a light theme with larger base text size for readability</span></span>
<span id="cb102-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="co"># Move the legend to the bottom for better layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index Price Visualization for the Period Ending in 2010</span></span>
<span id="cb103-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain2) <span class="sc">+</span> </span>
<span id="cb103-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcsesFTSE2010, <span class="at">series =</span> <span class="st">"SES Forecast"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb103-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE2, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb103-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'FTSE Index Price'</span>, <span class="at">col =</span> <span class="st">"Series"</span>) <span class="sc">+</span></span>
<span id="cb103-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price: SES Forecast vs. Actual (Ending 2010)'</span>) <span class="sc">+</span></span>
<span id="cb103-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb103-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index Price Visualization for the Period Ending in 2020</span></span>
<span id="cb104-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain3) <span class="sc">+</span> </span>
<span id="cb104-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fcsesFTSE2020, <span class="at">series =</span> <span class="st">"SES Forecast"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb104-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE3, <span class="at">series =</span> <span class="st">"Actual Price Movement"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb104-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Months Since Jan 1990"</span>, <span class="at">y =</span> <span class="st">'FTSE Index Price'</span>, <span class="at">col =</span> <span class="st">"Series"</span>) <span class="sc">+</span></span>
<span id="cb104-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE Index Price: SES Forecast vs. Actual (Ending 2020)'</span>) <span class="sc">+</span></span>
<span id="cb104-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb104-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb105-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb105-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb105-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate RMSE, MAE, and MAPE and return them in a data frame</span></span>
<span id="cb105-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-6" aria-hidden="true" tabindex="-1"></a>calculate_accuracy_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(forecast, actual) {</span>
<span id="cb105-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-7" aria-hidden="true" tabindex="-1"></a>  rmse_value <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((forecast<span class="sc">$</span>mean <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb105-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-8" aria-hidden="true" tabindex="-1"></a>  mae_value <span class="ot">&lt;-</span> <span class="fu">mae</span>(forecast<span class="sc">$</span>mean, actual)</span>
<span id="cb105-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-9" aria-hidden="true" tabindex="-1"></a>  mape_value <span class="ot">&lt;-</span> <span class="fu">mape</span>(forecast<span class="sc">$</span>mean, actual)</span>
<span id="cb105-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">RMSE =</span> rmse_value, <span class="at">MAE =</span> mae_value, <span class="at">MAPE =</span> mape_value))</span>
<span id="cb105-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating and storing the accuracy metrics in a data frame for each forecast</span></span>
<span id="cb105-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-15" aria-hidden="true" tabindex="-1"></a>accuracy_sp_2000 <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(fcsesSP2000, SP1)</span>
<span id="cb105-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-16" aria-hidden="true" tabindex="-1"></a>accuracy_sp_2010 <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(fcsesSP2010, SP2)</span>
<span id="cb105-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-17" aria-hidden="true" tabindex="-1"></a>accuracy_sp_2020 <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(fcsesSP2020, SP3)</span>
<span id="cb105-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-19" aria-hidden="true" tabindex="-1"></a>accuracy_ftse_2000 <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(fcsesFTSE2000, FTSE1)</span>
<span id="cb105-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-20" aria-hidden="true" tabindex="-1"></a>accuracy_ftse_2010 <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(fcsesFTSE2010, FTSE2)</span>
<span id="cb105-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-21" aria-hidden="true" tabindex="-1"></a>accuracy_ftse_2020 <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(fcsesFTSE2020, FTSE3)</span>
<span id="cb105-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-24"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-25"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-26"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining all results into a single data frame for tabulation</span></span>
<span id="cb105-28"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-28" aria-hidden="true" tabindex="-1"></a>accuracy_results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb105-29"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Year =</span> <span class="dv">2000</span>, <span class="at">Index =</span> <span class="st">"S&amp;P"</span>, accuracy_sp_2000),</span>
<span id="cb105-30"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Year =</span> <span class="dv">2010</span>, <span class="at">Index =</span> <span class="st">"S&amp;P"</span>, accuracy_sp_2010),</span>
<span id="cb105-31"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Year =</span> <span class="dv">2020</span>, <span class="at">Index =</span> <span class="st">"S&amp;P"</span>, accuracy_sp_2020),</span>
<span id="cb105-32"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Year =</span> <span class="dv">2000</span>, <span class="at">Index =</span> <span class="st">"FTSE"</span>, accuracy_ftse_2000),</span>
<span id="cb105-33"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Year =</span> <span class="dv">2010</span>, <span class="at">Index =</span> <span class="st">"FTSE"</span>, accuracy_ftse_2010),</span>
<span id="cb105-34"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="at">Year =</span> <span class="dv">2020</span>, <span class="at">Index =</span> <span class="st">"FTSE"</span>, accuracy_ftse_2020)</span>
<span id="cb105-35"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-36"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-37"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results in a tabulated format</span></span>
<span id="cb105-38"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(knitr<span class="sc">::</span><span class="fu">kable</span>(accuracy_results, <span class="at">format =</span> <span class="st">"markdown"</span>, <span class="at">caption =</span> <span class="st">"Accuracy Metrics for SES Forecasts"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Table: Accuracy Metrics for SES Forecasts

| Year|Index |     RMSE|      MAE|      MAPE|
|----:|:-----|--------:|--------:|---------:|
| 2000|S&amp;P   | 278.5528| 244.1336| 0.2540216|
| 2010|S&amp;P   | 210.2646| 184.8185| 0.2107027|
| 2020|S&amp;P   | 184.2390| 139.0517| 0.0499362|
| 2000|FTSE  | 436.5458| 390.9074| 0.1638655|
| 2010|FTSE  | 548.7732| 475.3065| 0.2234339|
| 2020|FTSE  | 247.2574| 206.1356| 0.0487819|</code></pre>
</div>
</div>
<p><strong>Insights from SES Forecast vs.&nbsp;Actual Data:</strong></p>
<p><strong>FTSE Index:</strong></p>
<p><strong>2000:</strong></p>
<ul>
<li><p>The SES forecast for the FTSE Index at the end of 2000 seems to have underestimated the actual performance. This is evidenced by the high RMSE and MAE values, indicating significant average errors in prediction.</p></li>
<li><p>The MAPE value of around 16% suggests that, on average, the forecast was off by this percentage from the actual values, highlighting the model’s limitations in capturing the market’s upward momentum during this period.</p></li>
</ul>
<p><strong>2010:</strong></p>
<ul>
<li><p>The forecast for 2010 captures some of the market’s movement but missed the full extent of the recovery following the 2008 financial crisis. This is reflected in the higher RMSE and MAE compared to 2020.</p></li>
<li><p>The increased MAPE indicates that the model’s percentage error relative to actual values grew, possibly due to the forecast’s failure to account for the post-crisis market volatility.</p></li>
</ul>
<p><strong>2020:</strong></p>
<ul>
<li><p>For 2020, the forecast aligns better with the actual trend but fails to account for the pandemic’s impact on market conditions, especially considering the sharp fluctuations.</p></li>
<li><p>The reduction in RMSE and MAE, compared to 2010, alongside a lower MAPE, implies a relatively better forecast performance. Yet, the forecast still falls short of accounting for the unprecedented market events of 2020.</p></li>
</ul>
<p><strong>S&amp;P 500 Index:</strong></p>
<p><strong>2000:</strong></p>
<ul>
<li><p>The SES forecast significantly diverges from the actual values, underestimating the late 1990s bull market’s impact leading up to the 2000 dot-com bubble burst.</p></li>
<li><p>The RMSE and MAE indicate substantial prediction errors, and the MAPE suggests that forecast values were about 25% off the actual figures.</p></li>
</ul>
<p><strong>2010:</strong></p>
<ul>
<li><p>In 2010, the forecast did not capture the severity of the market downturn and the subsequent recovery, resulting in considerable prediction errors, as seen with the FTSE Index.</p></li>
<li><p>The MAPE shows an error percentage of about 21%, which, while lower than in 2000, still denotes a sizeable forecast error.</p></li>
</ul>
<p><strong>2020:</strong></p>
<ul>
<li><p>The SES model’s predictions for 2020 were closer to actual values compared to 2000 and 2010, as indicated by the lowest RMSE and MAE among the three periods evaluated.</p></li>
<li><p>With the lowest MAPE, the 2020 forecast shows the model was better calibrated to the market conditions, although it did not fully capture the volatility introduced by the COVID-19 pandemic.</p></li>
</ul>
<p>Both indices showed similar patterns in forecast performance, with the SES model struggling to predict the more volatile market conditions accurately.Despite improvements, the inability of SES forecasts to account for the full range of economic conditions, especially unforeseen crises, points to the need for more sophisticated or hybrid models that can incorporate external factors and adjust to sudden market shifts.</p>
<p><strong>ARIMA FORECASTING</strong></p>
<p>The provided code snippet is dedicated to forecasting the future values of the S&amp;P and FTSE indices using the ARIMA (AutoRegressive Integrated Moving Average) model for three distinct periods: ending in the years 2000, 2010, and 2020.The code aims to forecast future values of the S&amp;P and FTSE indices for the next 24 periods (assumed to be months). This is a common practice in financial analysis and economic forecasting to predict future trends based on historical data.By employing the ARIMA model, a popular and versatile time series forecasting method, the code seeks to capture and utilize the historical data patterns of these indices, including trends, seasonality (if applicable), and noise, to make informed predictions about future movements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library for ARIMA modeling and forecasting</span></span>
<span id="cb107-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb107-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecasting the S&amp;P and FTSE indices for the year 2000</span></span>
<span id="cb107-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P Index Forecast Using ARIMA</span></span>
<span id="cb107-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-6" aria-hidden="true" tabindex="-1"></a>SParima2000 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(trainsp1, <span class="at">ic =</span> <span class="st">"aic"</span>)  <span class="co"># Automatically selects the best ARIMA model based on AIC</span></span>
<span id="cb107-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-7" aria-hidden="true" tabindex="-1"></a>SPfcarima2000 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(SParima2000, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Forecast next 24 periods for the S&amp;P index</span></span>
<span id="cb107-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co"># FTSE Index Forecast Using ARIMA</span></span>
<span id="cb107-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-10" aria-hidden="true" tabindex="-1"></a>FTSEarima2000 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(FTSEtrain1, <span class="at">ic =</span> <span class="st">"aic"</span>)  <span class="co"># Automatically selects the best ARIMA model for FTSE data</span></span>
<span id="cb107-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-11" aria-hidden="true" tabindex="-1"></a>FTSEfcarima2000 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(FTSEarima2000, <span class="at">h =</span> <span class="dv">24</span>)  <span class="co"># Forecast next 24 periods for the FTSE index</span></span>
<span id="cb107-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P and FTSE indices for the year 2010</span></span>
<span id="cb107-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-15" aria-hidden="true" tabindex="-1"></a>SParima2010 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(trainsp2, <span class="at">ic =</span> <span class="st">"aic"</span>)</span>
<span id="cb107-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-16" aria-hidden="true" tabindex="-1"></a>SPfcarima2010 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(SParima2010, <span class="at">h =</span> <span class="dv">24</span>)</span>
<span id="cb107-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-17" aria-hidden="true" tabindex="-1"></a>FTSEarima2010 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(FTSEtrain2, <span class="at">ic =</span> <span class="st">"aic"</span>)</span>
<span id="cb107-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-18" aria-hidden="true" tabindex="-1"></a>FTSEfcarima2010 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(FTSEarima2010, <span class="at">h =</span> <span class="dv">24</span>)</span>
<span id="cb107-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-20" aria-hidden="true" tabindex="-1"></a><span class="co"># S&amp;P and FTSE indices for the year 2020</span></span>
<span id="cb107-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-21" aria-hidden="true" tabindex="-1"></a>SParima2020 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(trainsp3, <span class="at">ic =</span> <span class="st">"aic"</span>)</span>
<span id="cb107-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-22" aria-hidden="true" tabindex="-1"></a>SPfcarima2020 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(SParima2020, <span class="at">h =</span> <span class="dv">24</span>)</span>
<span id="cb107-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-23" aria-hidden="true" tabindex="-1"></a>FTSEarima2020 <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(FTSEtrain3, <span class="at">ic =</span> <span class="st">"aic"</span>)</span>
<span id="cb107-24"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb107-24" aria-hidden="true" tabindex="-1"></a>FTSEfcarima2020 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(FTSEarima2020, <span class="at">h =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb108-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb108-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb108-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ARIMA Forecasting Visualization for S&amp;P 500 Index for 2000, 2010, and 2020</span></span>
<span id="cb108-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting forecasts and actual data together for comparison</span></span>
<span id="cb108-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2000 Forecast Plot</span></span>
<span id="cb108-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp1) <span class="sc">+</span> </span>
<span id="cb108-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SPfcarima2000, <span class="at">series=</span><span class="st">"ARIMA"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb108-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP1, <span class="at">series=</span><span class="st">"Actual"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb108-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'S&amp;P 500 Index Price'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span></span>
<span id="cb108-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 ARIMA Forecast vs. Actual (2000)'</span>) <span class="sc">+</span></span>
<span id="cb108-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb108-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2010 Forecast Plot</span></span>
<span id="cb109-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp2) <span class="sc">+</span> </span>
<span id="cb109-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SPfcarima2010, <span class="at">series=</span><span class="st">"ARIMA"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb109-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP2, <span class="at">series=</span><span class="st">"Actual"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb109-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'S&amp;P 500 Index Price'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span></span>
<span id="cb109-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 ARIMA Forecast vs. Actual (2010)'</span>) <span class="sc">+</span></span>
<span id="cb109-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2020 Forecast Plot</span></span>
<span id="cb110-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(trainsp3) <span class="sc">+</span> </span>
<span id="cb110-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SPfcarima2020, <span class="at">series=</span><span class="st">"ARIMA"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb110-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(SP3, <span class="at">series=</span><span class="st">"Actual"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'S&amp;P 500 Index Price'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span></span>
<span id="cb110-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'S&amp;P 500 ARIMA Forecast vs. Actual (2020)'</span>) <span class="sc">+</span></span>
<span id="cb110-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-23-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ARIMA Forecasting Visualization for FTSE Price index for 2000, 2010, and 2020</span></span>
<span id="cb111-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting forecasts and actual data together for comparison</span></span>
<span id="cb111-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ftse2000 arima Forecast Plot</span></span>
<span id="cb111-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain1) <span class="sc">+</span> </span>
<span id="cb111-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSEfcarima2000, <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb111-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE1, <span class="at">series=</span><span class="st">"Actual"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb111-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'FTSE  Price Index'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span></span>
<span id="cb111-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE ARIMA Forecast vs. Actual (2000)'</span>) <span class="sc">+</span></span>
<span id="cb111-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ftse2010 arima Forecast Plot</span></span>
<span id="cb112-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain2) <span class="sc">+</span> </span>
<span id="cb112-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSEfcarima2010, <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb112-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE2, <span class="at">series=</span><span class="st">"Actual"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'FTSE Price Index'</span>) <span class="sc">+</span></span>
<span id="cb112-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE ARIMA Forecast vs. Actual (2010)'</span>) <span class="sc">+</span></span>
<span id="cb112-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ftse2020 arima Forecast Plot</span></span>
<span id="cb113-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(FTSEtrain3) <span class="sc">+</span> </span>
<span id="cb113-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSEfcarima2020, <span class="at">series=</span><span class="st">"ARIMA"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb113-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(FTSE3, <span class="at">series=</span><span class="st">"Actual"</span>,<span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb113-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Months Since Jan 1990"</span>, <span class="at">y=</span><span class="st">'FTSE Price Index'</span>, <span class="at">col=</span><span class="st">"Forecast"</span>) <span class="sc">+</span></span>
<span id="cb113-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'FTSE ARIMA Forecast vs. Actual (2020)'</span>) <span class="sc">+</span></span>
<span id="cb113-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb114-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb114-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb114-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining a function to calculate RMSE, MAE, and MAPE</span></span>
<span id="cb114-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-6" aria-hidden="true" tabindex="-1"></a>calculate_accuracy_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(forecasted, actual) {</span>
<span id="cb114-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-7" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((forecasted <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb114-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-8" aria-hidden="true" tabindex="-1"></a>  mae <span class="ot">&lt;-</span> <span class="fu">mae</span>(forecasted, actual)</span>
<span id="cb114-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-9" aria-hidden="true" tabindex="-1"></a>  mape <span class="ot">&lt;-</span> <span class="fu">mape</span>(forecasted, actual)</span>
<span id="cb114-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">RMSE =</span> rmse, <span class="at">MAE =</span> mae, <span class="at">MAPE =</span> mape))</span>
<span id="cb114-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating RMSE, MAE, and MAPE for the S&amp;P 500 Index Forecasts</span></span>
<span id="cb114-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-14" aria-hidden="true" tabindex="-1"></a>SP_2000_accuracy <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(SPfcarima2000<span class="sc">$</span>mean, SP1)</span>
<span id="cb114-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-15" aria-hidden="true" tabindex="-1"></a>SP_2010_accuracy <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(SPfcarima2010<span class="sc">$</span>mean, SP2)</span>
<span id="cb114-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-16" aria-hidden="true" tabindex="-1"></a>SP_2020_accuracy <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(SPfcarima2020<span class="sc">$</span>mean, SP3)</span>
<span id="cb114-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating RMSE, MAE, and MAPE for the FTSE Price Index Forecasts</span></span>
<span id="cb114-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-19" aria-hidden="true" tabindex="-1"></a>FTSE_2000_accuracy <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(FTSEfcarima2000<span class="sc">$</span>mean, FTSE1)</span>
<span id="cb114-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-20" aria-hidden="true" tabindex="-1"></a>FTSE_2010_accuracy <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(FTSEfcarima2010<span class="sc">$</span>mean, FTSE2)</span>
<span id="cb114-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-21" aria-hidden="true" tabindex="-1"></a>FTSE_2020_accuracy <span class="ot">&lt;-</span> <span class="fu">calculate_accuracy_metrics</span>(FTSEfcarima2020<span class="sc">$</span>mean, FTSE3)</span>
<span id="cb114-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the AIC from each ARIMA model</span></span>
<span id="cb114-24"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-24" aria-hidden="true" tabindex="-1"></a>SP_2000_AIC <span class="ot">&lt;-</span> SParima2000<span class="sc">$</span>aic</span>
<span id="cb114-25"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-25" aria-hidden="true" tabindex="-1"></a>SP_2010_AIC <span class="ot">&lt;-</span> SParima2010<span class="sc">$</span>aic</span>
<span id="cb114-26"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-26" aria-hidden="true" tabindex="-1"></a>SP_2020_AIC <span class="ot">&lt;-</span> SParima2020<span class="sc">$</span>aic</span>
<span id="cb114-27"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-28"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-28" aria-hidden="true" tabindex="-1"></a>FTSE_2000_AIC <span class="ot">&lt;-</span> FTSEarima2000<span class="sc">$</span>aic</span>
<span id="cb114-29"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-29" aria-hidden="true" tabindex="-1"></a>FTSE_2010_AIC <span class="ot">&lt;-</span> FTSEarima2010<span class="sc">$</span>aic</span>
<span id="cb114-30"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-30" aria-hidden="true" tabindex="-1"></a>FTSE_2020_AIC <span class="ot">&lt;-</span> FTSEarima2020<span class="sc">$</span>aic</span>
<span id="cb114-31"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-32"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining all accuracy metrics and AIC into a data frame</span></span>
<span id="cb114-33"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-33" aria-hidden="true" tabindex="-1"></a>accuracy_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb114-34"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Year =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb114-35"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">Index =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"S&amp;P"</span>, <span class="st">"FTSE"</span>), <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb114-36"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">c</span>(SP_2000_accuracy<span class="sc">$</span>RMSE, FTSE_2000_accuracy<span class="sc">$</span>RMSE,</span>
<span id="cb114-37"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-37" aria-hidden="true" tabindex="-1"></a>           SP_2010_accuracy<span class="sc">$</span>RMSE, FTSE_2010_accuracy<span class="sc">$</span>RMSE,</span>
<span id="cb114-38"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-38" aria-hidden="true" tabindex="-1"></a>           SP_2020_accuracy<span class="sc">$</span>RMSE, FTSE_2020_accuracy<span class="sc">$</span>RMSE),</span>
<span id="cb114-39"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> <span class="fu">c</span>(SP_2000_accuracy<span class="sc">$</span>MAE, FTSE_2000_accuracy<span class="sc">$</span>MAE,</span>
<span id="cb114-40"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-40" aria-hidden="true" tabindex="-1"></a>          SP_2010_accuracy<span class="sc">$</span>MAE, FTSE_2010_accuracy<span class="sc">$</span>MAE,</span>
<span id="cb114-41"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-41" aria-hidden="true" tabindex="-1"></a>          SP_2020_accuracy<span class="sc">$</span>MAE, FTSE_2020_accuracy<span class="sc">$</span>MAE),</span>
<span id="cb114-42"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAPE =</span> <span class="fu">c</span>(SP_2000_accuracy<span class="sc">$</span>MAPE, FTSE_2000_accuracy<span class="sc">$</span>MAPE,</span>
<span id="cb114-43"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-43" aria-hidden="true" tabindex="-1"></a>           SP_2010_accuracy<span class="sc">$</span>MAPE, FTSE_2010_accuracy<span class="sc">$</span>MAPE,</span>
<span id="cb114-44"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-44" aria-hidden="true" tabindex="-1"></a>           SP_2020_accuracy<span class="sc">$</span>MAPE, FTSE_2020_accuracy<span class="sc">$</span>MAPE),</span>
<span id="cb114-45"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(SP_2000_AIC, FTSE_2000_AIC,</span>
<span id="cb114-46"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-46" aria-hidden="true" tabindex="-1"></a>          SP_2010_AIC, FTSE_2010_AIC,</span>
<span id="cb114-47"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-47" aria-hidden="true" tabindex="-1"></a>          SP_2020_AIC, FTSE_2020_AIC)</span>
<span id="cb114-48"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-49"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-50"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results using knitr::kable for a clean table format</span></span>
<span id="cb114-51"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb114-51" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(accuracy_results, <span class="at">caption =</span> <span class="st">"ARIMA Forecast Accuracy Metrics"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>ARIMA Forecast Accuracy Metrics</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Year</th>
<th style="text-align: left;">Index</th>
<th style="text-align: right;">RMSE</th>
<th style="text-align: right;">MAE</th>
<th style="text-align: right;">MAPE</th>
<th style="text-align: right;">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">S&amp;P</td>
<td style="text-align: right;">82.2564</td>
<td style="text-align: right;">73.67735</td>
<td style="text-align: right;">0.0636941</td>
<td style="text-align: right;">775.2603</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">FTSE</td>
<td style="text-align: right;">262.4185</td>
<td style="text-align: right;">235.56501</td>
<td style="text-align: right;">0.0915601</td>
<td style="text-align: right;">1000.3146</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">S&amp;P</td>
<td style="text-align: right;">210.1071</td>
<td style="text-align: right;">184.68519</td>
<td style="text-align: right;">0.2105027</td>
<td style="text-align: right;">2290.3138</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">FTSE</td>
<td style="text-align: right;">547.7214</td>
<td style="text-align: right;">474.33206</td>
<td style="text-align: right;">0.2228398</td>
<td style="text-align: right;">2657.7236</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">S&amp;P</td>
<td style="text-align: right;">146.0124</td>
<td style="text-align: right;">115.56283</td>
<td style="text-align: right;">0.0398384</td>
<td style="text-align: right;">3435.2316</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">FTSE</td>
<td style="text-align: right;">365.5704</td>
<td style="text-align: right;">333.83695</td>
<td style="text-align: right;">0.0765009</td>
<td style="text-align: right;">3963.1431</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Detailed Analysis of ARIMA Forecast Plots:</strong></p>
<ol type="1">
<li><p><strong>FTSE ARIMA Forecast vs.&nbsp;Actual (2000):</strong> The ARIMA model’s forecast trajectory begins in congruence with the actual data, tracking the underlying trend closely. However, towards the later months, the model’s forecast curve deviates, undervaluing the actual rise in the index. This divergence could be attributed to the model’s inability to predict the more volatile trend that emerges towards the end of the forecast period. The expanding forecast interval also reflects increasing uncertainty, a natural consequence of projecting further into the future.</p></li>
<li><p><strong>FTSE ARIMA Forecast vs.&nbsp;Actual (2010 &amp; 2020):</strong> In these two time frames, the model appears to adjust better to the rising and falling patterns exhibited in the actual data. Particularly in 2020, the model’s forecast confidence intervals are narrower, which could imply that the underlying data patterns were more stable or that the model’s parameters were better tuned to capture the prevailing trends during this period.</p></li>
<li><p><strong>S&amp;P 500 ARIMA Forecast vs.&nbsp;Actual (2000, 2010 &amp; 2020):</strong> The S&amp;P 500 forecasts display an interesting progression. In the year 2000, the model tracks closely with the actual index, suggesting an accurate fit. By 2010, there is a visible discrepancy between the forecast and actual data, where the model seems to lag the actual trend slightly. This could be an indicator of model parameters not capturing some of the market dynamics. In 2020, despite a good initial fit, the model fails to anticipate a steep rise in the index, indicating potential model limitations in reacting to abrupt market movements.</p></li>
</ol>
<p><strong>Interpretation of Accuracy Metrics:</strong></p>
<ul>
<li><p><strong>RMSE &amp; MAE (2000-2020):</strong> For both indices, these metrics show that the forecast errors are smallest in the 2000 forecasts and largest in 2010, before decreasing again in 2020. This might indicate that the time series data during the 2010 period had more volatility or unexpected movements that the model could not anticipate.</p></li>
<li><p><strong>MAPE (2000-2020):</strong> Lower MAPE values in 2020 across both indices suggest that while there might have been large price movements, they were more predictable based on historical patterns, or alternatively, the actual values were higher, which tends to lower the MAPE.</p></li>
<li><p><strong>AIC (2000-2020):</strong> The rising AIC values suggest that the models are becoming more complex, possibly to account for increased volatility or non-stationary behaviors in the data. A lower AIC is generally preferred, indicating a model that fits well without unnecessary complexity.</p></li>
</ul>
<p><strong>Limitations and Scope for Improvement:</strong></p>
<ul>
<li><p><strong>Overfitting Risk:</strong> The accuracy of the forecasts could be compromised if the models are overfitted to historical data. This risk needs to be managed by regular back-testing against out-of-sample data.</p></li>
<li><p><strong>Market Shocks and Black Swan Events:</strong> Financial markets are susceptible to unpredictable events that can cause significant deviations from forecasted trends. ARIMA models, being solely historical data-driven, are not equipped to predict such events.</p></li>
<li><p><strong>Stationarity Assumption:</strong> ARIMA models assume that the data has a consistent mean and variance over time, an assumption often violated in financial time series due to market cycles and volatility clustering.</p></li>
<li><p><strong>Model Enhancement:</strong> Integrating additional variables such as macroeconomic indicators, sentiment analysis, or leading financial indicators could enhance the model’s predictive power.</p></li>
<li><p><strong>Higher-Frequency Data:</strong> Utilizing daily or weekly data could help capture short-term fluctuations and provide a more granular view of market dynamics.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb115-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb115-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and select the best model based on AIC for S&amp;P 500 data</span></span>
<span id="cb115-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-5" aria-hidden="true" tabindex="-1"></a>best_arima_SP <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(trainsp1, <span class="at">ic =</span> <span class="st">"aic"</span>)</span>
<span id="cb115-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-6" aria-hidden="true" tabindex="-1"></a>forecast_SP <span class="ot">&lt;-</span> <span class="fu">forecast</span>(best_arima_SP, <span class="at">h =</span> <span class="fu">length</span>(SP1))</span>
<span id="cb115-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast against the actual data</span></span>
<span id="cb115-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(forecast_SP, <span class="at">main=</span><span class="st">"Best ARIMA Model for S&amp;P 500"</span>)</span>
<span id="cb115-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(SP1, <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">size=</span><span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy.coords(x, y), type = type, ...): "size" is not a
graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model and select the best model based on AIC for FTSE data</span></span>
<span id="cb117-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb117-2" aria-hidden="true" tabindex="-1"></a>best_arima_FTSE <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(FTSEtrain1, <span class="at">ic =</span> <span class="st">"aic"</span>)</span>
<span id="cb117-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb117-3" aria-hidden="true" tabindex="-1"></a>forecast_FTSE <span class="ot">&lt;-</span> <span class="fu">forecast</span>(best_arima_FTSE, <span class="at">h =</span> <span class="fu">length</span>(FTSE1))</span>
<span id="cb117-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast against the actual data</span></span>
<span id="cb117-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(forecast_FTSE, <span class="at">main=</span><span class="st">"Best ARIMA Model for FTSE"</span>)</span>
<span id="cb117-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(FTSE1, <span class="at">col =</span> <span class="st">'black'</span>, <span class="at">size=</span> <span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in plot.xy(xy.coords(x, y), type = type, ...): "size" is not a
graphical parameter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb119-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb119-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb119-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to automatically fit an ARIMA model and select the one with the least AIC</span></span>
<span id="cb119-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-6" aria-hidden="true" tabindex="-1"></a>fit_arima_select_least_aic <span class="ot">&lt;-</span> <span class="cf">function</span>(time_series_data) {</span>
<span id="cb119-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit ARIMA model automatically</span></span>
<span id="cb119-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-8" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(time_series_data, <span class="at">stepwise =</span> <span class="cn">TRUE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the fitted model</span></span>
<span id="cb119-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(model)</span>
<span id="cb119-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models for S&amp;P 500 data for different time horizons</span></span>
<span id="cb119-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-15" aria-hidden="true" tabindex="-1"></a>model_sp1 <span class="ot">&lt;-</span> <span class="fu">fit_arima_select_least_aic</span>(trainsp1)</span>
<span id="cb119-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-16" aria-hidden="true" tabindex="-1"></a>model_sp2 <span class="ot">&lt;-</span> <span class="fu">fit_arima_select_least_aic</span>(trainsp2)</span>
<span id="cb119-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-17" aria-hidden="true" tabindex="-1"></a>model_sp3 <span class="ot">&lt;-</span> <span class="fu">fit_arima_select_least_aic</span>(trainsp3)</span>
<span id="cb119-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Display AIC values and model summaries to compare</span></span>
<span id="cb119-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model for 1990-2000 (SP1) AIC:"</span>, model_sp1<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for 1990-2000 (SP1) AIC: 775.2603 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model for 1990-2010 (SP2) AIC:"</span>, model_sp2<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for 1990-2010 (SP2) AIC: 2288.841 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model for 1990-2020 (SP3) AIC:"</span>, model_sp3<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for 1990-2020 (SP3) AIC: 3435.232 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparing and selecting the model with the lowest AIC for S&amp;P 500</span></span>
<span id="cb125-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb125-2" aria-hidden="true" tabindex="-1"></a>aic_values_sp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">SP1 =</span> model_sp1<span class="sc">$</span>aic, <span class="at">SP2 =</span> model_sp2<span class="sc">$</span>aic, <span class="at">SP3 =</span> model_sp3<span class="sc">$</span>aic)</span>
<span id="cb125-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb125-3" aria-hidden="true" tabindex="-1"></a>min_aic_sp <span class="ot">&lt;-</span> <span class="fu">min</span>(aic_values_sp)</span>
<span id="cb125-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Minimum AIC value for S&amp;P 500 is:"</span>, min_aic_sp, <span class="st">"for Model:"</span>, <span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_sp)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum AIC value for S&amp;P 500 is: 775.2603 for Model: SP1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating plots for more detailed analysis with the model with least AIC value</span></span>
<span id="cb127-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting actual data vs forecast data for S&amp;P 500</span></span>
<span id="cb127-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the forecast for the model with the lowest AIC</span></span>
<span id="cb127-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_sp)) <span class="sc">==</span> <span class="st">"SP1"</span>) {</span>
<span id="cb127-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-6" aria-hidden="true" tabindex="-1"></a>  forecast_sp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_sp1, <span class="at">h =</span> <span class="fu">length</span>(SP1))</span>
<span id="cb127-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-7" aria-hidden="true" tabindex="-1"></a>  actual_sp <span class="ot">&lt;-</span> SP1</span>
<span id="cb127-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_sp)) <span class="sc">==</span> <span class="st">"SP2"</span>) {</span>
<span id="cb127-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-9" aria-hidden="true" tabindex="-1"></a>  forecast_sp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_sp2, <span class="at">h =</span> <span class="fu">length</span>(SP2))</span>
<span id="cb127-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-10" aria-hidden="true" tabindex="-1"></a>  actual_sp <span class="ot">&lt;-</span> SP2</span>
<span id="cb127-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb127-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-12" aria-hidden="true" tabindex="-1"></a>  forecast_sp <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_sp3, <span class="at">h =</span> <span class="fu">length</span>(SP3))</span>
<span id="cb127-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-13" aria-hidden="true" tabindex="-1"></a>  actual_sp <span class="ot">&lt;-</span> SP3</span>
<span id="cb127-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the forecast against the actual data for S&amp;P 500</span></span>
<span id="cb127-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-17" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(forecast_sp, <span class="at">series=</span><span class="st">"Forecast"</span>) <span class="sc">+</span></span>
<span id="cb127-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(actual_sp, <span class="at">series=</span><span class="st">"Actual"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb127-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">"S&amp;P 500 Forecast vs Actual with least AIC-SP1 ("</span>, <span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_sp)), <span class="st">")"</span>), <span class="at">x=</span><span class="st">"Time"</span>, <span class="at">y=</span><span class="st">"Index Price"</span>) <span class="sc">+</span></span>
<span id="cb127-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb127-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"Forecast"</span><span class="ot">=</span><span class="st">"#0072B2"</span>, <span class="st">"Actual"</span><span class="ot">=</span><span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb127-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb127-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>, <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots for S&amp;P 500 ARIMA model residuals</span></span>
<span id="cb129-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb129-2" aria-hidden="true" tabindex="-1"></a>residuals_sp <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_sp1) <span class="co"># Replace with the model chosen by min AIC</span></span>
<span id="cb129-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ACF of residuals</span></span>
<span id="cb129-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Acf</span>(residuals_sp, <span class="at">main =</span> <span class="st">"ACF of Residuals for S&amp;P 500 model with lowest AIC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PACF of residuals</span></span>
<span id="cb130-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(residuals_sp, <span class="at">main =</span> <span class="st">"PACF of Residuals for S&amp;P 500 model with lowest AIC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-27-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of residuals</span></span>
<span id="cb131-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(residuals_sp, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Histogram of Residuals for S&amp;P 500 model with lowest AIC"</span>, <span class="at">xlab =</span> <span class="st">"Residuals"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-27-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot with normal curve overlay</span></span>
<span id="cb132-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb132-2" aria-hidden="true" tabindex="-1"></a>residuals_density_sp <span class="ot">&lt;-</span> <span class="fu">density</span>(residuals_sp)</span>
<span id="cb132-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residuals_density_sp, <span class="at">main =</span> <span class="st">"Density of Residuals for S&amp;P 500 model with lowest AIC"</span>, <span class="at">xlab =</span> <span class="st">"Residuals"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>)</span>
<span id="cb132-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_sp), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_sp)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-27-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>let’s delve into a detailed analysis of the <strong>ARIMA model performance for the S&amp;P 500 index</strong>, specifically focusing on the model with the <strong>lowest AIC value</strong>. The provided plots give us a comprehensive look into different aspects of the model’s fit and residuals.:</p>
<p><strong>Insights from the ACF Plot</strong>:</p>
<p>In examining the ACF plot for the S&amp;P 500 model with the lowest AIC, I observed that the autocorrelations seem to be hovering near the zero line within the confidence intervals. This suggests that the residuals of the model do not show significant patterns or correlations at the displayed lags, indicating a potentially good fit. It’s almost like the model has managed to capture the essence of the data’s movement, leaving behind residuals that appear to be just random noise. It’s interesting to see such randomness, as it implies that there isn’t much left to explain or any hidden patterns we’re missing, which makes me feel more confident about the model’s performance. However, I’m mindful that this doesn’t completely rule out room for improvement; there could be complexity or seasonality that we might uncover with a more extensive analysis or by looking at a broader range of lags.</p>
<p><strong>Insights from the PACF Plot</strong>:</p>
<p>The PACF (Partial Autocorrelation Function) plot provides a nuanced perspective on the residuals of our S&amp;P 500 model with the lowest AIC. It’s intriguing to note that all the partial autocorrelations are within the confidence bounds, which hints at a good fit — the lags don’t seem to provide additional information that could improve the model significantly. What strikes me as particularly noteworthy is the absence of significant spikes, suggesting that each lagged value has little to no partial correlation with the future values beyond what is already explained by the model. It’s as if the ARIMA model we’ve crafted has adeptly encapsulated the predictive essence of the time series. Nonetheless, it’s important to consider this as a preliminary analysis. There’s a part of me that remains curious about whether incorporating additional external variables or exploring alternative models could unveil further hidden patterns.</p>
<p><strong>Insights from the Histogram</strong>:</p>
<p>Observing the histogram of residuals for our S&amp;P 500 model, I find it quite insightful. The distribution of residuals does not perfectly mimic a normal distribution, showing some skewness. Most notably, there’s a concentration around the zero mark, which suggests that the model predictions are often on target. However, the spread of the residuals indicates variability that isn’t captured by the model. This could be due to market volatility or other factors not included in our model. What stands out to me is the potential for further model refinement. Perhaps considering volatility clustering or other non-linear aspects could fine-tune our predictions. This graph has definitely piqued my interest in exploring more complex models that might better account for the patterns in the residuals.</p>
<p><strong>Insights from the Density plot:</strong></p>
<p>The density plot of the residuals for our S&amp;P 500 ARIMA model reveals that while the residuals are roughly symmetrical, suggesting that the model doesn’t systematically over or under-predict, there’s a slight skew that may point to infrequent but substantive deviations from the actual values. The red line, representing the normal distribution, shows that our residuals are not perfectly normal with some observable kurtosis, indicating that there may be more extreme values than expected in normal conditions. These could be due to market shocks or unusual events not captured by the model. This visual analysis reminds me of the importance of considering these factors and maybe incorporating additional variables or using different models to better capture the tails of the distribution. This density plot is a visual reinforcement of the notion that market predictions are often fraught with complexities beyond standard models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models for FTSE data for different time horizons</span></span>
<span id="cb133-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb133-2" aria-hidden="true" tabindex="-1"></a>model_ftse1 <span class="ot">&lt;-</span> <span class="fu">fit_arima_select_least_aic</span>(FTSEtrain1)</span>
<span id="cb133-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb133-3" aria-hidden="true" tabindex="-1"></a>model_ftse2 <span class="ot">&lt;-</span> <span class="fu">fit_arima_select_least_aic</span>(FTSEtrain2)</span>
<span id="cb133-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb133-4" aria-hidden="true" tabindex="-1"></a>model_ftse3 <span class="ot">&lt;-</span> <span class="fu">fit_arima_select_least_aic</span>(FTSEtrain3)</span>
<span id="cb133-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display AIC values and model summaries to compare</span></span>
<span id="cb133-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model for 1990-2000 (FTSE1) AIC:"</span>, model_ftse1<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for 1990-2000 (FTSE1) AIC: 1000.315 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model for 1990-2010 (FTSE2) AIC:"</span>, model_ftse2<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for 1990-2010 (FTSE2) AIC: 2657.724 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model for 1990-2020 (FTSE3) AIC:"</span>, model_ftse3<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for 1990-2020 (FTSE3) AIC: 3962.548 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparing and selecting the model with the lowest AIC for FTSE</span></span>
<span id="cb139-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb139-2" aria-hidden="true" tabindex="-1"></a>aic_values_ftse <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">FTSE1 =</span> model_ftse1<span class="sc">$</span>aic, <span class="at">FTSE2 =</span> model_ftse2<span class="sc">$</span>aic, <span class="at">FTSE3 =</span> model_ftse3<span class="sc">$</span>aic)</span>
<span id="cb139-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb139-3" aria-hidden="true" tabindex="-1"></a>min_aic_ftse <span class="ot">&lt;-</span> <span class="fu">min</span>(aic_values_ftse)</span>
<span id="cb139-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Minimum AIC value for FTSE is:"</span>, min_aic_ftse, <span class="st">"for Model:"</span>, <span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_ftse)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum AIC value for FTSE is: 1000.315 for Model: FTSE1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating plots for more detailed analysis with the model with least AIC value</span></span>
<span id="cb141-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting actual data vs forecast data for FTSE</span></span>
<span id="cb141-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the forecast for the model with the lowest AIC</span></span>
<span id="cb141-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_ftse)) <span class="sc">==</span> <span class="st">"FTSE1"</span>) {</span>
<span id="cb141-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-6" aria-hidden="true" tabindex="-1"></a>  forecast_ftse <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_ftse1, <span class="at">h =</span> <span class="fu">length</span>(FTSE1))</span>
<span id="cb141-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-7" aria-hidden="true" tabindex="-1"></a>  actual_ftse <span class="ot">&lt;-</span> FTSE1</span>
<span id="cb141-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_ftse)) <span class="sc">==</span> <span class="st">"FTSE2"</span>) {</span>
<span id="cb141-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-9" aria-hidden="true" tabindex="-1"></a>  forecast_ftse <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_ftse2, <span class="at">h =</span> <span class="fu">length</span>(FTSE2))</span>
<span id="cb141-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-10" aria-hidden="true" tabindex="-1"></a>  actual_ftse <span class="ot">&lt;-</span> FTSE2</span>
<span id="cb141-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb141-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-12" aria-hidden="true" tabindex="-1"></a>  forecast_ftse <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model_ftse3, <span class="at">h =</span> <span class="fu">length</span>(FTSE3))</span>
<span id="cb141-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-13" aria-hidden="true" tabindex="-1"></a>  actual_ftse <span class="ot">&lt;-</span> FTSE3</span>
<span id="cb141-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the forecast against the actual data for FTSE</span></span>
<span id="cb141-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(forecast_ftse, <span class="at">series=</span><span class="st">"Forecast"</span>) <span class="sc">+</span></span>
<span id="cb141-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(actual_ftse, <span class="at">series=</span><span class="st">"Actual"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb141-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">"FTSE Forecast vs Actual with lowest AIC  ("</span>, <span class="fu">names</span>(<span class="fu">which.min</span>(aic_values_ftse)), <span class="st">")"</span>), <span class="at">x=</span><span class="st">"Time"</span>, <span class="at">y=</span><span class="st">"Index Price"</span>) <span class="sc">+</span></span>
<span id="cb141-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb141-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"Forecast"</span><span class="ot">=</span><span class="st">"#0072B2"</span>, <span class="st">"Actual"</span><span class="ot">=</span><span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb141-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb141-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>, <span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots for FTSE ARIMA model residuals</span></span>
<span id="cb143-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb143-2" aria-hidden="true" tabindex="-1"></a>residuals_ftse <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_ftse1) <span class="co"># Replace with the model chosen by min AIC</span></span>
<span id="cb143-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ACF of residuals</span></span>
<span id="cb143-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Acf</span>(residuals_ftse, <span class="at">main =</span> <span class="st">"ACF of Residuals for FTSE model with lowest AIC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PACF of residuals</span></span>
<span id="cb144-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Pacf</span>(residuals_ftse, <span class="at">main =</span> <span class="st">"PACF of Residuals for FTSE model with lowest AIC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-28-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of residuals</span></span>
<span id="cb145-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(residuals_ftse, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Histogram of Residuals for FTSE model with lowest AIC"</span>, <span class="at">xlab =</span> <span class="st">"Residuals"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-28-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot with normal curve overlay</span></span>
<span id="cb146-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb146-2" aria-hidden="true" tabindex="-1"></a>residuals_density_ftse <span class="ot">&lt;-</span> <span class="fu">density</span>(residuals_ftse)</span>
<span id="cb146-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(residuals_density_ftse, <span class="at">main =</span> <span class="st">"Density of Residuals for FTSE model with lowest AIC"</span>, <span class="at">xlab =</span> <span class="st">"Residuals"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>)</span>
<span id="cb146-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(residuals_ftse), <span class="at">sd =</span> <span class="fu">sd</span>(residuals_ftse)), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-28-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now,detailed analysis of the <strong>ARIMA model performance for the S&amp;P 500 index</strong>, specifically focusing on the model with the <strong>lowest AIC value</strong>:</p>
<p><strong>Insights from the ACF Plot</strong>:</p>
<p>The Autocorrelation Function (ACF) plot for the FTSE model’s residuals, chosen based on its lowest Akaike Information Criterion (AIC), offers an interesting perspective on the temporal structure left in the series after fitting the model. Ideally, we would expect to see all the autocorrelations within the blue dashed confidence intervals, indicating that there are no significant autocorrelations at different lags. However, our plot shows a few spikes that just exceed the bounds, especially at the initial lags. This could imply that the model has not fully captured the underlying process, perhaps due to some seasonality or short-term momentum effects not accounted for in the model. From a student’s standpoint, this suggests a learning opportunity to delve deeper into model diagnostics and explore additional parameters or model structures that could potentially capture these autocorrelations. It’s a reminder that statistical models are simplifications of reality, and the residuals can often reveal patterns that prompt further investigation and learning.</p>
<p><strong>Insights from the PACF Plot</strong>:</p>
<p>The Partial Autocorrelation Function (PACF) plot gives us a nuanced look into the direct relationship between an observation and its lag, excluding influences of the intermediates. For the FTSE model with the lowest AIC, the PACF plot here shows that most of the spikes fall within the confidence intervals, which is quite promising as it suggests that there is no significant partial autocorrelation at these lags. However, it’s critical to point out that the absence of significant spikes doesn’t necessarily mean the model is perfect. There could still be some missing dynamics not captured by the model, or perhaps even overfitting if the model is too complex. This plot prompts me to consider whether the model complexity is appropriate and whether there is more to uncover in the data’s story—perhaps through other types of models or additional data exploration. It’s a reminder that in statistical learning, the lack of evidence for a relationship is not evidence of absence and encourages continual curiosity and scrutiny.</p>
<p><strong>Insights from the Histogram</strong>:</p>
<p>The histogram of residuals for the FTSE model with the lowest AIC reveals a distribution that appears somewhat asymmetric, which could be indicative of skewness in the residuals. The presence of outliers or a long tail on one side suggests that there might be extreme values that the model does not predict well. A perfectly fitted model would ideally have a symmetric, bell-shaped distribution of residuals, indicating that the model’s predictions are unbiased and that the variance is consistent across the range of predictions. The skewness seen here may suggest that some of the underlying assumptions used in the model might not hold, such as homoscedasticity or normality of error terms. It’s crucial to investigate further — possibly transforming the data or considering a different model that can account for this asymmetry. This insight encourages me to be meticulous and critical in the model evaluation process and reminds me that each statistical artifact has a story to tell about the data.</p>
<p><strong>Insights from the Density plot</strong>:</p>
<p>The density plot of the residuals for the FTSE model with the lowest AIC is a clear illustration of how well the model fits the data.It’s fascinating to see that the plotted density appears to follow the classic bell curve quite closely, which is encouraging because it suggests that the residuals are approximately normally distributed. The red line, presumably the normal distribution, seems to be closely aligned with the peak of the residuals’ density, indicating that the model’s predictions are on average correct, with errors symmetrically distributed around zero.</p>
<p>However, I also notice that the tails of the density plot are a tad heavier than the normal distribution’s tails, which may imply the presence of outliers or extreme values not captured by the model, known as kurtosis. This might affect the prediction intervals and suggests that the model could potentially be improved by addressing these anomalies, perhaps through more robust modeling techniques or by incorporating additional variables that explain the extreme fluctuations in the data.</p>
<p><strong>SEASONAL TREND&nbsp;DECOMPOSITION</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb147-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb147-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensuring the ts objects have the correct frequency</span></span>
<span id="cb147-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming monthly data with yearly seasonality</span></span>
<span id="cb147-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-6" aria-hidden="true" tabindex="-1"></a>trainsp1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(trainsp1, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb147-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-7" aria-hidden="true" tabindex="-1"></a>trainsp2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(trainsp2, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb147-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-8" aria-hidden="true" tabindex="-1"></a>trainsp3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(trainsp3, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb147-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if each series has at least two full seasonal cycles</span></span>
<span id="cb147-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This means at least 24 observations for monthly data with yearly seasonality</span></span>
<span id="cb147-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(trainsp1) <span class="sc">&gt;=</span> <span class="dv">24</span>) {</span>
<span id="cb147-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-13" aria-hidden="true" tabindex="-1"></a>  stl_sp1 <span class="ot">&lt;-</span> <span class="fu">stl</span>(trainsp1, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb147-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(stl_sp1) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"STL Decomposition of S&amp;P 500 (1990-2000)"</span>)</span>
<span id="cb147-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-15" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb147-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"trainsp1 does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb147-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(trainsp2) <span class="sc">&gt;=</span> <span class="dv">24</span>) {</span>
<span id="cb148-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb148-2" aria-hidden="true" tabindex="-1"></a>  stl_sp2 <span class="ot">&lt;-</span> <span class="fu">stl</span>(trainsp2, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb148-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(stl_sp2) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"STL Decomposition of S&amp;P 500 (1990-2010)"</span>)</span>
<span id="cb148-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb148-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb148-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"trainsp2 does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb148-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb148-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-29-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(trainsp3) <span class="sc">&gt;=</span> <span class="dv">24</span>) {</span>
<span id="cb149-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb149-2" aria-hidden="true" tabindex="-1"></a>  stl_sp3 <span class="ot">&lt;-</span> <span class="fu">stl</span>(trainsp3, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb149-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(stl_sp3) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"STL Decomposition of S&amp;P 500 (1990-2020)"</span>)</span>
<span id="cb149-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb149-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb149-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"trainsp1 does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb149-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb149-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-29-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform STL decomposition and forecasting</span></span>
<span id="cb150-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-2" aria-hidden="true" tabindex="-1"></a>perform_stl_forecasting <span class="ot">&lt;-</span> <span class="cf">function</span>(time_series, <span class="at">h =</span> <span class="dv">24</span>, title_suffix) {</span>
<span id="cb150-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure the time series has enough data points and correct frequency</span></span>
<span id="cb150-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(time_series) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">frequency</span>(time_series)) {</span>
<span id="cb150-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STL Decomposition</span></span>
<span id="cb150-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-6" aria-hidden="true" tabindex="-1"></a>    stl_decomp <span class="ot">&lt;-</span> <span class="fu">stl</span>(time_series, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb150-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autoplot</span>(stl_decomp) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"STL Decomposition of S&amp;P 500"</span>, title_suffix))</span>
<span id="cb150-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb150-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Forecasting based on decomposition</span></span>
<span id="cb150-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-10" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(stl_decomp<span class="sc">$</span>time.series[, <span class="st">"remainder"</span>], <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb150-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-11" aria-hidden="true" tabindex="-1"></a>    forecast_res <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> h)</span>
<span id="cb150-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autoplot</span>(forecast_res) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Forecast of S&amp;P 500 Remainder"</span>, title_suffix))</span>
<span id="cb150-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb150-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Time series for"</span>, title_suffix, <span class="st">"does not have enough data points or correct frequency for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb150-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to each time frame</span></span>
<span id="cb150-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb150-19" aria-hidden="true" tabindex="-1"></a><span class="fu">perform_stl_forecasting</span>(trainsp1, <span class="dv">24</span>, <span class="st">"(1990-2000)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-29-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">perform_stl_forecasting</span>(trainsp2, <span class="dv">24</span>, <span class="st">"(1990-2010)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-29-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">perform_stl_forecasting</span>(trainsp3, <span class="dv">24</span>, <span class="st">"(1990-2020)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-29-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>ANALYSIS AND INSIGHTS SEASONAL TREND DECOMPOSITION OF S&amp;P500 INDEX</strong></p>
<p><strong>1990-2000:</strong>The STL decomposition of the S&amp;P 500 index from 1990 to 2000 reveals a steadily increasing trend component, indicating a period of economic growth and bullish market conditions during this decade. The seasonal component does not display strong, regular patterns, which suggests that any seasonality present over this period was relatively subdued or overshadowed by other market forces. This could be due to the unique characteristics of the index or external factors affecting the market during these years.</p>
<p>In contrast, the remainder component, which captures the irregular fluctuations after seasonal and trend effects have been accounted for, shows some volatility. This might reflect market reactions to specific events or news during this period that could not be explained by the seasonal or trend components. For instance, the spike in the remainder’s forecast towards the end of the period might correspond with the dot-com bubble’s impact on market prices.</p>
<p><strong>1990-2010:</strong>For the second period (1990-2010), we observe a more pronounced trend that captures the rise and fall of the market, including the dot-com bubble burst and the early stages of recovery post the 2008 financial crisis. The seasonal component in this period still shows a clear pattern, which doesn’t seem to be significantly affected by the market’s upheavals, suggesting that the seasonal behavior of the index is robust to larger economic shocks. The remainder shows increased volatility during this period, which could be attributed to the higher market volatility in those years.</p>
<p>The forecast plots provide a predictive look at the short-term future based on the remainder component. The forecasts for both periods feature a confidence interval that widens over time, indicating increasing uncertainty as the forecast extends further from the known data.</p>
<p><strong>1990-2020:</strong>The STL decomposition of the S&amp;P 500 from 1990 to 2020 reveals that the overall trend has been upward, indicating growth in the index value over the 30-year period. The seasonal component presents a consistent pattern that repeats over time, suggesting regular fluctuations within the year which could be linked to cyclical market behaviors. The remainder component, which captures the irregularities in the data not explained by the seasonal or trend components, shows considerable volatility, with no discernible pattern.</p>
<p>The forecast of the S&amp;P 500 remainder for the same period shows an extension of this volatility into the future, with the shaded area indicating the confidence intervals around the forecast. This area becomes wider as the forecast extends further out, reflecting increasing uncertainty. The actual remainder oscillates around the zero line without a clear direction, emphasizing the unpredictable nature of short-term fluctuations in the S&amp;P 500. The forecast suggests that, while the long-term trend might be upward, short-term movements are less predictable and subject to sudden changes, which is typical of stock market behavior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb153-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb153-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensuring the ts objects have the correct frequency</span></span>
<span id="cb153-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming monthly data with yearly seasonality</span></span>
<span id="cb153-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-6" aria-hidden="true" tabindex="-1"></a>FTSEtrain1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(FTSEtrain1, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb153-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-7" aria-hidden="true" tabindex="-1"></a>FTSEtrain2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(FTSEtrain2, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb153-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-8" aria-hidden="true" tabindex="-1"></a>fTSEtrain3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(FTSEtrain3, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb153-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if each series has at least two full seasonal cycles</span></span>
<span id="cb153-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This means at least 24 observations for monthly data with yearly seasonality</span></span>
<span id="cb153-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(FTSEtrain1) <span class="sc">&gt;=</span> <span class="dv">24</span>) {</span>
<span id="cb153-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-13" aria-hidden="true" tabindex="-1"></a>  stl_FTSE1 <span class="ot">&lt;-</span> <span class="fu">stl</span>(FTSEtrain1, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb153-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(stl_FTSE1) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"STL Decomposition of FTSE(1990-2000)"</span>)</span>
<span id="cb153-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-15" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb153-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"trainsp1 does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb153-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb153-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(FTSEtrain2) <span class="sc">&gt;=</span> <span class="dv">24</span>) {</span>
<span id="cb154-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb154-2" aria-hidden="true" tabindex="-1"></a>  stl_FTSE2 <span class="ot">&lt;-</span> <span class="fu">stl</span>(FTSEtrain2, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb154-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(stl_FTSE2) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"STL Decomposition of FTSE(1990-2010)"</span>)</span>
<span id="cb154-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb154-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb154-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"trainsp2 does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb154-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb154-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-30-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correcting the variable name and ensuring it is properly formatted as a time series</span></span>
<span id="cb155-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-2" aria-hidden="true" tabindex="-1"></a>FTSEtrain3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(FTSEtrain3, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb155-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking if the series has at least 24 data points for STL decomposition</span></span>
<span id="cb155-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(FTSEtrain3) <span class="sc">&gt;=</span> <span class="dv">24</span>) {</span>
<span id="cb155-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-6" aria-hidden="true" tabindex="-1"></a>  stl_FTSE3 <span class="ot">&lt;-</span> <span class="fu">stl</span>(FTSEtrain3, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb155-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(stl_FTSE3) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"STL Decomposition of FTSE (1990-2020)"</span>)</span>
<span id="cb155-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb155-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"FTSEtrain3 does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb155-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb155-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-30-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(FTSEtrain3) <span class="sc">&gt;=</span> <span class="dv">24</span>) {</span>
<span id="cb156-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb156-2" aria-hidden="true" tabindex="-1"></a>  stl_FTSE3 <span class="ot">&lt;-</span> <span class="fu">stl</span>(FTSEtrain3, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb156-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(stl_FTSE3) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"STL Decomposition of FTSE (1990-2020)"</span>)</span>
<span id="cb156-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb156-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb156-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"trainsp1 does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb156-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb156-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-30-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to check series length, perform STL decomposition, and forecasting</span></span>
<span id="cb157-2"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-2" aria-hidden="true" tabindex="-1"></a>perform_stl_forecasting_ftse <span class="ot">&lt;-</span> <span class="cf">function</span>(time_series, title_suffix) {</span>
<span id="cb157-3"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ensure the time series has enough data points and correct frequency</span></span>
<span id="cb157-4"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(time_series) <span class="sc">&gt;=</span> <span class="dv">24</span>) {  <span class="co"># Assuming yearly seasonality for monthly data</span></span>
<span id="cb157-5"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform STL Decomposition</span></span>
<span id="cb157-6"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-6" aria-hidden="true" tabindex="-1"></a>    stl_decomp <span class="ot">&lt;-</span> <span class="fu">stl</span>(time_series, <span class="at">s.window =</span> <span class="st">"periodic"</span>)</span>
<span id="cb157-7"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autoplot</span>(stl_decomp) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"STL Decomposition of FTSE"</span>, title_suffix))</span>
<span id="cb157-8"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb157-9"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Forecasting based on the remainder component</span></span>
<span id="cb157-10"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-10" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(stl_decomp<span class="sc">$</span>time.series[, <span class="st">"remainder"</span>], <span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb157-11"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-11" aria-hidden="true" tabindex="-1"></a>    forecast_res <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> <span class="dv">24</span>)</span>
<span id="cb157-12"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autoplot</span>(forecast_res) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Forecast of FTSE Remainder"</span>, title_suffix))</span>
<span id="cb157-13"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb157-14"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"The FTSE series for"</span>, title_suffix, <span class="st">"does not have enough data points for STL decomposition.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb157-15"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb157-16"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-17"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-18"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure FTSE time series objects have the correct frequency</span></span>
<span id="cb157-19"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-19" aria-hidden="true" tabindex="-1"></a>FTSEtrain1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(FTSEtrain1, <span class="at">frequency =</span> <span class="dv">12</span>)  <span class="co"># Assuming monthly data</span></span>
<span id="cb157-20"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-20" aria-hidden="true" tabindex="-1"></a>FTSEtrain2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(FTSEtrain2, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb157-21"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-21" aria-hidden="true" tabindex="-1"></a>FTSEtrain3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(FTSEtrain3, <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb157-22"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-23"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to each FTSE time frame</span></span>
<span id="cb157-24"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb157-24" aria-hidden="true" tabindex="-1"></a><span class="fu">perform_stl_forecasting_ftse</span>(FTSEtrain1, <span class="st">"(1990-2000)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-30-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">perform_stl_forecasting_ftse</span>(FTSEtrain2, <span class="st">"(1990-2010)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-30-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">perform_stl_forecasting_ftse</span>(FTSEtrain3, <span class="st">"(1990-2020)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="./Advanced Financial Data Analytics Assignment 1_files/unnamed-chunk-30-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>ANALYSIS AND INSIGHTS SEASONAL TREND DECOMPOSITION OF FTSE PRICE INDEX</strong></p>
<p><strong>1990-2000:</strong>The STL decomposition for the FTSE index over the decade from 1990 to 2000 shows a steady upward trend, which means that generally, the market was doing pretty well during this time. You can spot the seasonal ups and downs that repeat each year; maybe investors were feeling extra confident or cautious during certain seasons. The remainder graph, though, looks kind of like a roller coaster ride with lots of unpredictable bumps—these could be due to unexpected news or events affecting the market.</p>
<p>Looking at the forecast for the remainder of the FTSE, the line gets wobbly with a shaded area around it getting wider as it goes further out. This is just like saying, “We have a hunch about what might happen next, but don’t bet all your lunch money on it!” It’s like weather forecasting for stocks; we can guess what might happen based on what usually happens around this time, but there’s always a chance of a surprise.</p>
<p><strong>1990-2010:</strong>The STL decomposition chart for the FTSE index from 1990 to 2010 indicates that the overall market trend increased, showing growth over the 20-year span. The seasonal component exhibits regular fluctuations that repeat annually, indicative of consistent patterns in market behavior. The remainder component, which accounts for noise not explained by the trend or seasonality, exhibits significant volatility, suggesting that the index was affected by numerous irregular factors, likely including economic events and market sentiment.</p>
<p>The forecast chart for the remainder of the FTSE indicates a continuation of this volatility, with the forecasted values demonstrating uncertainty, as reflected by the widening confidence interval. The forecast suggests potential for unpredictable fluctuations in the short term, which is typical in financial markets where many unforeseeable factors can impact prices. Overall, these insights indicate a general growth in the FTSE index over the period, with an expectation of continued short-term volatility.</p>
<p><strong>1990-2020:</strong>The STL decomposition for the FTSE from 1990 to 2020 displays a steady overall increase in the data line, showing long-term growth in the index. The seasonal component suggests regular, predictable patterns in the index’s movements throughout the years. The remainder, or the noise in the data, seems quite erratic, with swings that appear to have increased in amplitude over time, suggesting that unexpected events have caused more pronounced short-term impacts on the index as time progressed.</p>
<p>The forecast for the remainder of the FTSE reflects the unpredictable nature of these short-term movements, with a forecast line that is quite wavy and a confidence interval that grows wider the further out we look. This indicates that the certainty about the index’s direction decreases as we try to predict further into the future, which is consistent with the complex and uncertain nature of financial markets. The broadening confidence interval in the forecast suggests that while the index’s trend has been upwards over the past 30 years, its short-term movements are difficult to predict and could be influenced by a variety of unforeseen factors.</p>
</section>
</section>
<section id="discussion-of-results" class="level3">
<h3 class="anchored" data-anchor-id="discussion-of-results"><strong>Discussion of Results</strong><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#discussion-of-results" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h3>
<section id="original-aim" class="level4">
<h4 class="anchored" data-anchor-id="original-aim">Original Aim<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#original-aim" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<p>The primary aim of this project was to investigate the evidence of long-term predictability in stock market index returns by analyzing historical index returns to identify patterns or trends that suggest predictability over different time horizons. The forecasting models employed included Simple Forecasts (Mean, Naive, and Drift), Moving Averages, Simple Exponential Smoothing (SES), ARIMA, and Seasonal-Trend Decomposition.</p>
</section>
<section id="key-results-and-insights" class="level4">
<h4 class="anchored" data-anchor-id="key-results-and-insights">Key Results and Insights<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#key-results-and-insights" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<p><strong>Simple Forecasts:</strong></p>
<ul>
<li><p>The Drift method demonstrated relative superiority in aligning with the actual trends of the FTSE and S&amp;P 500 indices by incorporating a trend component, particularly evident with RMSE values of 254.9292 for S&amp;P 500 and 507.9728 for FTSE in the year 2000. However, its failure to predict sudden market downturns, such as the 2008 financial crisis, underscores its limitations.</p></li>
<li><p>The Mean and Naive methods systematically underestimated market performance across all time horizons, reflecting their basic assumption that past conditions persist without adequately adapting to market dynamics.</p></li>
</ul>
<p><strong>Moving Averages:</strong></p>
<ul>
<li>This model smoothed out short-term fluctuations but exhibited significant prediction errors during periods of market volatility, as seen with RMSE values reaching up to 340.7512 for S&amp;P 500 in 2010 and 590.9151 for FTSE in the same year. The inability to foresee drastic market changes like the 2008 crisis was a notable deficiency.</li>
</ul>
<p><strong>Simple Exponential Smoothing (SES):</strong></p>
<ul>
<li>SES offered improvements in prediction accuracy with lower RMSE and MAE across the years, particularly in 2020, where the RMSE for S&amp;P 500 was 184.2390 and for FTSE was 247.2574. This model adapted better to changing market conditions compared to simpler forecasting methods.</li>
</ul>
<p><strong>ARIMA:</strong></p>
<ul>
<li>ARIMA provided the best overall forecasting accuracy among the models used, particularly highlighted by its lower RMSE and MAE, such as an RMSE of 82.2564 for the S&amp;P 500 in 2000. Despite its complexity, ARIMA struggled with predicting the sudden onset of the COVID-19 pandemic, illustrating the challenges of modeling unprecedented events.</li>
</ul>
<p><strong>Seasonal-Trend Decomposition:</strong></p>
<ul>
<li>The decomposition revealed consistent seasonal patterns and a general upward trend in both indices, aiding in understanding underlying market behaviors. However, the model’s forecasts indicated increasing uncertainty in predictions further out into the future, which was evident from the widening confidence intervals in the forecast plots.</li>
</ul>
</section>
<section id="weaknesses-of-the-study" class="level4">
<h4 class="anchored" data-anchor-id="weaknesses-of-the-study">Weaknesses of the Study<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#weaknesses-of-the-study" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<p>While the study provides comprehensive insights into the predictability of stock market indices, several weaknesses are apparent:</p>
<ul>
<li><p><strong>Model Limitations</strong>: None of the forecasting models could adequately anticipate sudden, drastic changes in the market, such as economic crises or pandemics.</p></li>
<li><p><strong>Data Constraints</strong>: The reliance on historical data without incorporating potential external variables (e.g., geopolitical events, economic policies) possibly limited the forecasting accuracy.</p></li>
<li><p><strong>Methodological Simplifications</strong>: The simpler models, while beneficial for understanding basic trends, were often inadequate for capturing complex market dynamics.</p></li>
</ul>
</section>
<section id="directions-for-future-research" class="level4">
<h4 class="anchored" data-anchor-id="directions-for-future-research">Directions for Future Research<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#directions-for-future-research" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<p>Future research should aim to integrate more complex and varied data sources, including macroeconomic indicators, geopolitical events, and even sentiment analysis from news and financial reports to enhance the predictive accuracy of the models. Additionally, exploring machine learning and artificial intelligence for predictive analytics could offer significant advancements in understanding and forecasting market movements. Developing models that can dynamically adjust to sudden market changes and test their robustness in scenarios like the 2008 financial crisis or the COVID-19 pandemic could also prove invaluable.</p>
</section>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion">Conclusion<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="https://9c1f88ae7ae0476a93a472b3632eb80e.app.posit.cloud/p/6ae6682a/#conclusion" style="font: 1em / 1 anchorjs-icons; margin-left: 0.1875em; padding-right: 0.1875em; padding-left: 0.1875em;"></a></h4>
<p>This study underscores the complexities of forecasting stock market returns and highlights the inherent limitations of traditional and simplistic models in predicting dynamic and volatile markets. While some models showed better adaptability and accuracy, the need for more sophisticated analytical tools is evident to handle the unpredictable nature of financial markets effectively. This project not only contributes to academic knowledge but also opens several avenues for future research that could bridge the gap between theoretical forecasting and real-world market behavior.</p>
<p><strong>REFERENCES</strong></p>
<p>Ariyo, A.A., Adewumi, A.O., &amp; Ayo, C.K. (2014). Stock Price Prediction Using the ARIMA Model. In Proceedings of the 16th International Conference on Computer Modelling and Simulation (UKSim-AMSS), pp.&nbsp;106-112. Cambridge, UK. doi: 10.1109/UKSim.2014.67.</p>
<p>Vozlyublennaia, N. (2014). Investor attention, index performance, and return predictability. Journal of Banking &amp; Finance, 41, 17–35. Area of Finance, Rawls College of Business Administration, Texas Tech University, Lubbock, TX 79409-2101, United States.</p>
<p>Kara, Y., Boyacioglu, M.A., &amp; Baykan, Ö.K. (2011). Predicting direction of stock price index movement using artificial neural networks and support vector machines: The sample of the Istanbul Stock Exchange. Expert Systems with Applications, 38(5), 5311-5319. ISSN 0957-4174. doi: 10.1016/j.eswa.2010.10.027. Abstract retrieved from: <a href="https://www.sciencedirect.com/science/article/pii/S0957417410011711" class="uri">https://www.sciencedirect.com/science/article/pii/S0957417410011711</a></p>
<p><strong>APPENDIX</strong></p>
<p><strong>REFLECTIVE ESSAY ON YOUR USE OF GENAI+LLMS</strong></p>
<p>In the context of financial research and analytics, the integration of Generative AI and Large Language Models (LLMs) marks a watershed moment. As someone deeply immersed in the nuances of financial data analysis through projects with the ChatGPT, my insights on these technologies stem from a blend of hands-on experience and critical evaluation of their broader implications.</p>
<p><strong>Critique and Personal Experiences</strong></p>
<p>Throughout my academic pursuits, particularly in projects that required R programming prowess, I’ve witnessed the duality of GenAI and LLMs. On one hand, these systems have been nothing short of a revelation. Their computational power has aided in dissecting complex financial datasets, offering forecasts and statistical insights at an unprecedented scale. During my project on time series analysis with the ChatGPT, I observed how models could swiftly identify patterns in data, which traditionally would have required laborious manual effort.</p>
<p>However, the reliance on GenAI and LLMs is not without concern. One pressing issue is the ‘black box’ dilemma—how can we trust the predictions of an algorithm we cannot fully interpret? This challenge became evident when I was working with ARIMA models. The machine provided results, yet the rationale behind these results was often obscure, which made it difficult to justify decisions based solely on these outputs.</p>
<p><strong>Ethical Considerations</strong></p>
<p>From an ethical standpoint, the advent of these technologies raises several red flags. In one instance, while utilizing LLMs for market trend analysis, I pondered the ramifications of data privacy breaches. Additionally, there is the potential for job displacement—what roles will remain for aspiring financial analysts like myself if AI continues to encroach on our domain?</p>
<p>Furthermore, the very real possibility of exacerbating existing inequalities cannot be ignored. If AI tools become exclusive to those with the means to access them, the financial industry risks becoming even more impenetrable for the underprivileged.</p>
<p><strong>Originality and Insightful Analysis</strong></p>
<p>True innovation, I’ve learned, is not about the sophistication of tools, but rather the originality in their application. It’s about the unique touch we bring to these technologies, ensuring they cater to specific contexts. My project work taught me that while algorithms can process and predict, they fall short of understanding the human elements that drive financial markets.</p>
<p>The originality in my approach was never about reinventing the wheel but rather about tailoring these AI solutions to serve the financial models I developed, ensuring they provided actionable insights rather than just data regurgitation.</p>
<p><strong>Reflecting on the ChatGPT</strong> <strong>Project History</strong></p>
<p>Reflecting on my journey with the ChatGPT, it’s evident that while GenAI and LLMs are formidable allies in financial analytics, their utility ultimately hinges on the user’s acumen and integrity. It’s our responsibility to apply these tools in a manner that is transparent, equitable, and above all, mindful of the ethical ramifications.</p>
<p>In summation, GenAI and LLMs have the potential to be transformative in financial research and analytics, but their application requires a careful blend of ethical consideration, critical thinking, and personal ingenuity. As I advance in my academic and professional career, I aim to navigate this complex terrain with a commitment to these principles, ensuring that my reliance on AI is complemented by an unwavering dedication to ethical standards and original analysis.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->





<script>window.backupDefine = window.define; window.define = undefined;</script>
<script type="text/javascript" src="./Advanced Financial Data Analytics Assignment 1_files/quarto-preview.js.download"></script>
<script>window.define = window.backupDefine; window.backupDefine = undefined;</script>
<script type="text/javascript">
  const options = {
    origin: "",
    search: "",
    inputFile: "/cloud/project/AFDA project assignment/AFDA Assignment.qmd",
    isPresentation: false
  }
  document.addEventListener("DOMContentLoaded", function () {
    window.QuartoPreview.init(options);
  });
</script>
<div><div dir="ltr" class="fui-FluentProvider fui-FluentProviderr0 ___jdtuxv0 f19n0e5 fxugw4r f1o700av fk6fouc fkhj508 figsok6 f1i3iumi"></div></div><i tabindex="0" role="none" data-tabster-dummy="" aria-hidden="true" style="position: fixed; height: 1px; width: 1px; opacity: 0.001; z-index: -1; content-visibility: hidden; top: 0px; left: 0px;"></i></body></html>